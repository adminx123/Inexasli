<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Your Social Media Package - INEXASLI</title>
    <link rel="stylesheet" href="salesflow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="../../images/favicon.ico" type="image/x-icon">
    <style>
        /* Page-specific styles for packages.html */
        /* Package-card styles moved to salesflow.css */
        
        /* Platform Selection Grid - Single Row Layout */
        .platform-selection-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: nowrap;
            margin: 35px 0 15px 0; /* Increased top margin to make room for +$15 */
            position: relative;
        }
        
        .platform-option {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
            position: relative;
        }
        
        .platform-option:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(16, 185, 129, 0.5);
            transform: scale(1.05);
        }
        
        .platform-option.selected {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
        }
        
        .platform-option i {
            font-size: 24px;
            color: #ccc;
        }
        
        .platform-option.selected i {
            color: #10b981;
        }
        
        .extra-cost-indicator {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: #10b981;
            font-size: 12px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            z-index: 10;
        }
        
        .package-platforms.show-extra-cost .extra-cost-indicator {
            opacity: 1;
        }
        
        /* Page-specific styles for packages.html */
        /* Package-card styles moved to salesflow.css */
        
        /* Addon card state management */
        .feature-status {
            color: #10b981;
            font-size: 11px;
            font-weight: bold;
            float: right;
            white-space: nowrap;
        }

        .total-label {
            color: #ccc;
            font-size: 14px;
        }

        .total-amount {
            color: #4CAF50;
            font-size: 24px;
            font-weight: bold;
        }

        .total-period {
            color: #ccc;
            font-size: 14px;
        }        .package-platforms h4, .package-addons h4 {
            color: #fff;
            font-size: 16px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .platform-note {
            text-align: center;
            color: #ccc;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .no-addons-message {
            text-align: center;
            color: #ccc;
            font-size: 14px;
            margin: 15px 0;
            font-style: italic;
        }
        
        /* Continue Button */
        .continue-container {
            text-align: center;
            margin: 30px 0 20px 0;
        }

        /* Addon Cards */
        .addons-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 6px;
            margin-top: 10px;
        }

        .package-continue-btn {
            width: 100%;
            margin-top: 20px;
            padding: 12px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .package-continue-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .package-continue-btn:disabled {
            background: rgba(255,255,255,0.1);
            color: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
    </style>
</head>
<body>
    <div class="splash-container" id="splashContainer" style="padding-top: 40px; position: absolute; top: 0; left: 0; width: 100%; z-index: 2;">
        <img src="../../images/favicon.svg" alt="INEXASLI Logo" class="splash-logo" style="margin-top: 20px;">
    </div>

    <div class="device-container" id="mainContent" style="opacity: 0; display: block; z-index: 1;">
            
            <!-- Currency Selector -->
            <div class="currency-selector-container">
                <div class="currency-selector">
                    <span class="currency-label">Your Currency:</span>
                    <select id="currencySelect" class="currency-select">
                        <option value="CAD" data-symbol="$">ðŸ‡¨ðŸ‡¦ CAD ($)</option>
                        <option value="USD" data-symbol="$">ðŸ‡ºðŸ‡¸ USD ($)</option>
                        <option value="EUR" data-symbol="â‚¬">ðŸ‡ªðŸ‡º EUR (â‚¬)</option>
                        <option value="GBP" data-symbol="Â£">ðŸ‡¬ðŸ‡§ GBP (Â£)</option>
                        <option value="AUD" data-symbol="$">ðŸ‡¦ðŸ‡º AUD ($)</option>
                    </select>
                </div>
            </div>

            <!-- Step Indicator -->
                        <!-- Step Indicator -->
            <div class="step-indicator-placeholder"></div>
            
            <!-- Page Title -->
            <h1 class="page-title">Choose Package</h1>
            <p class="page-subtitle">Select the type of AI solution that fits your business needs.</p><!-- Package Cards -->
<div class="package-cards">
  <div class="package-card selected" data-package="basic">
    <div class="package-header">
      <h3>Basic Chat</h3>
      <div class="price" id="basic-price">$99/month</div>
    </div>
    <ul>
      <li class="core-feature included">
        <span class="feature-name">AI chat widget for websites</span>
        <span class="feature-status">Included</span>
      </li>
      <li class="core-feature included">
        <span class="feature-name">Easy embed</span>
        <span class="feature-status">Included</span>
      </li>
    </ul>

    <!-- Package Customization (shown when selected) -->
    <div class="package-platforms" style="display: none;">
      <h4>Customize Your Package</h4>
      <p class="no-addons-message">No addons available for Basic Chat</p>
    </div>

    <button class="package-continue-btn" style="display: none;">Continue to Customization</button>
  </div>

  <div class="package-card" data-package="social">
    <div class="package-header">
      <h3>Social Starter</h3>
      <div class="price" id="social-price">$149/month</div>
    </div>
    <ul>
      <li class="core-feature included">
        <span class="feature-name">AI chat + AI-generated social content</span>
        <span class="feature-status">Included</span>
      </li>
      <li class="core-feature included">
        <span class="feature-name">1 platform included</span>
        <span class="feature-status">Included</span>
      </li>
    </ul>

    <!-- Package Customization (shown when selected) -->
    <div class="package-platforms" style="display: none;">
      <h4>Customize Your Package</h4>
      
      <!-- Platform Selection -->
      <div class="platform-selection-grid">
        <div class="platform-option" data-platform="instagram">
          <i class="fab fa-instagram"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="twitter">
          <i class="fab fa-twitter"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="facebook">
          <i class="fab fa-facebook"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
      </div>
      
      <!-- Add-ons -->
      <div class="addons-grid">
        <!-- Extra Photos -->
        <div class="addon-card" data-addon="photos-10" data-price="50">
          <span class="addon-name">+10 Photo Storage</span>
          <span class="addon-price">+$50</span>
        </div>

        <!-- Extra Videos -->
        <div class="addon-card" data-addon="videos-5" data-price="75">
          <span class="addon-name">+5 Video Storage</span>
          <span class="addon-price">+$75</span>
        </div>

        <!-- Extra Iterations -->
        <div class="addon-card included" data-addon="iterations-extra" data-price="150">
          <span class="addon-name">+10 Content Refinements</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- AI Content Generation -->
        <div class="addon-card" data-addon="ai-content-generation" data-price="200">
          <span class="addon-name">AI Content Generation</span>
          <span class="addon-price">+$200</span>
        </div>

        <!-- White-label Chat -->
        <div class="addon-card" data-addon="white-label-chat" data-price="150">
          <span class="addon-name">White-label Chat</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- Discount Options -->
        <div class="addon-card discount-addon" data-addon="basic-scheduling" data-price="-25">
          <span class="addon-name">Basic Scheduling Only</span>
          <span class="addon-price">-$25</span>
        </div>

        <div class="addon-card discount-addon" data-addon="reduced-frequency" data-price="-15">
          <span class="addon-name">Reduced Posting Frequency</span>
          <span class="addon-price">-$15</span>
        </div>
      </div>
    </div>
    <button class="package-continue-btn" style="display: none;">Continue to Customization</button>
  </div>

  <div class="package-card" data-package="pro">
    <div class="package-header">
      <h3>Pro Bundle</h3>
      <div class="price" id="pro-price">$299/month</div>
    </div>
    <ul>
      <li class="core-feature included">
        <span class="feature-name">AI chat + message replies + AI social content</span>
        <span class="feature-status">Included</span>
      </li>
      <li class="core-feature included">
        <span class="feature-name">2 platforms included</span>
        <span class="feature-status">Included</span>
      </li>
    </ul>

    <!-- Platform Selection (shown when selected) -->
    <div class="package-platforms" style="display: none;">
      <h4>Customize Your Package</h4>
      <div class="platform-selection-grid">
        <div class="platform-option" data-platform="instagram">
          <i class="fab fa-instagram"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="twitter">
          <i class="fab fa-twitter"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="facebook">
          <i class="fab fa-facebook"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
      </div>

      <!-- Add-ons -->
      <div class="addons-grid">
        <!-- Extra Photos -->
        <div class="addon-card" data-addon="photos-10" data-price="50">
          <span class="addon-name">+10 Photo Storage</span>
          <span class="addon-price">+$50</span>
        </div>

        <!-- Extra Videos -->
        <div class="addon-card" data-addon="videos-5" data-price="75">
          <span class="addon-name">+5 Video Storage</span>
          <span class="addon-price">+$75</span>
        </div>

        <!-- Extra Iterations -->
        <div class="addon-card" data-addon="iterations-extra" data-price="150">
          <span class="addon-name">+10 Content Refinements</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- AI Content Generation -->
        <div class="addon-card" data-addon="ai-content-generation" data-price="200">
          <span class="addon-name">AI Content Generation</span>
          <span class="addon-price">+$200</span>
        </div>

        <!-- White-label Chat -->
        <div class="addon-card" data-addon="white-label-chat" data-price="150">
          <span class="addon-name">White-label Chat</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- Discount Options -->
        <div class="addon-card discount-addon" data-addon="basic-scheduling" data-price="-25">
          <span class="addon-name">Basic Scheduling Only</span>
          <span class="addon-price">-$25</span>
        </div>

        <div class="addon-card discount-addon" data-addon="reduced-frequency" data-price="-15">
          <span class="addon-name">Reduced Posting Frequency</span>
          <span class="addon-price">-$15</span>
        </div>
      </div>
    </div>
    <button class="package-continue-btn" style="display: none;">Continue to Customization</button>
  </div>

  <div class="package-card" data-package="enterprise">
    <div class="package-header">
      <h3>Enterprise</h3>
      <div class="price" id="enterprise-price">$499/month</div>
    </div>
    <ul>
      <li class="core-feature included">
        <span class="feature-name">Full AI suite + all platforms + white-label</span>
        <span class="feature-status">Included</span>
      </li>
      <li class="core-feature included">
        <span class="feature-name">Dedicated support</span>
        <span class="feature-status">Included</span>
      </li>
    </ul>

    <!-- Platform Selection (shown when selected) -->
    <div class="package-platforms" style="display: none;">
      <h4>Customize Your Package</h4>
      <div class="platform-selection-grid">
        <div class="platform-option" data-platform="instagram">
          <i class="fab fa-instagram"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="twitter">
          <i class="fab fa-twitter"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
        <div class="platform-option" data-platform="facebook">
          <i class="fab fa-facebook"></i>
          <span class="extra-cost-indicator">+$15</span>
        </div>
      </div>

      <!-- Add-ons -->
      <div class="addons-grid">
        <!-- Extra Photos -->
        <div class="addon-card" data-addon="photos-10" data-price="50">
          <span class="addon-name">+10 Photo Storage</span>
          <span class="addon-price">+$50</span>
        </div>

        <!-- Extra Videos -->
        <div class="addon-card" data-addon="videos-5" data-price="75">
          <span class="addon-name">+5 Video Storage</span>
          <span class="addon-price">+$75</span>
        </div>

        <!-- Extra Iterations -->
        <div class="addon-card" data-addon="iterations-extra" data-price="150">
          <span class="addon-name">+10 Content Refinements</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- AI Content Generation -->
        <div class="addon-card" data-addon="ai-content-generation" data-price="200">
          <span class="addon-name">AI Content Generation</span>
          <span class="addon-price">+$200</span>
        </div>

        <!-- White-label Chat -->
        <div class="addon-card" data-addon="white-label-chat" data-price="150">
          <span class="addon-name">White-label Chat</span>
          <span class="addon-price">+$150</span>
        </div>

        <!-- Discount Options -->
        <div class="addon-card discount-addon" data-addon="basic-scheduling" data-price="-25">
          <span class="addon-name">Basic Scheduling Only</span>
          <span class="addon-price">-$25</span>
        </div>

        <div class="addon-card discount-addon" data-addon="reduced-frequency" data-price="-15">
          <span class="addon-name">Reduced Posting Frequency</span>
          <span class="addon-price">-$15</span>
        </div>
      </div>
    </div>
    <button class="package-continue-btn" style="display: none;">Continue to Customization</button>
  </div>
</div>

<!-- Continue Button -->
<div class="continue-container" style="display: none;">
  <button id="continue-btn" class="btn-continue-to-quote" disabled>Continue to Customization</button>
</div>

<!-- Legal Footer -->
<div style="text-align: center; margin: 10px 0 20px 0; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
    <p style="color: #ccc; font-size: 12px; margin: 0;">
        <a href="#" onclick="showSocialTerms(); return false;" style="color: #4CAF50; text-decoration: none;">Terms of Service</a>
        â€¢ 
        <a href="#" onclick="showSocialPrivacy(); return false;" style="color: #4CAF50; text-decoration: none;">Privacy Policy</a>
        â€¢ Contact: support@inexasli.com
    </p>
</div>

</div>
    <script>
        // Splash screen transition
        const splash = document.getElementById('splashContainer');
        const main = document.getElementById('mainContent');
        
        // Start main content fade-in immediately
        main.style.transition = 'opacity 1.2s ease-in';
        
        setTimeout(() => {
            // Start crossfade
            main.style.opacity = '1';
            splash.style.opacity = '0';
            splash.style.transition = 'opacity 1.2s ease-out';
            
            setTimeout(() => {
                splash.style.display = 'none';
                main.style.position = 'static';
            }, 1200);
        }, 1500); // Show splash for 1.5 seconds

    </script>
    
    <!-- Splash Screen Transition Script -->
    <script>
        // Splash screen transition
        document.addEventListener('DOMContentLoaded', function() {
            const splash = document.getElementById('splashContainer');
            const main = document.getElementById('mainContent');
            
            // Initialize currency selector
            initializeCurrencySelector();
            
            // Start main content fade-in immediately
            main.style.transition = 'opacity 1.2s ease-in';
            
            setTimeout(() => {
                // Start crossfade
                main.style.opacity = '1';
                splash.style.opacity = '0';
                splash.style.transition = 'opacity 1.2s ease-out';
                
                setTimeout(() => {
                    splash.style.display = 'none';
                    main.style.position = 'static';
                }, 1200);
            }, 1500); // Show splash for 1.5 seconds
        });
    </script>
    
    <!-- Chat Widget Configuration -->
    <script>
        window.INEXASLI_CONFIG = {
            apiUrl: 'https://hub-inexasli.4hm7q4q75z.workers.dev'
        };
    </script>
    
    <!-- Chat Widget Script -->
    <script src="https://144a1766.master-widget.pages.dev/masterWidget.js"></script>
    
    <script src="../../utility/modal.js"></script>
    <script src="../../utility/currency.js"></script>
    <script src="../legal/legalSocial.js"></script>
    <script src="step-indicator.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const packageCards = document.querySelectorAll('.package-card');
            const packageCardsContainer = document.querySelector('.package-cards');
            
            let selectedPackage = null;
            let selectedAddons = [];
            let selectedPlatforms = [];
            let packageSelections = {}; // Store selections per package
            
            // Base prices for each package (should never change)
            const basePrices = {
                basic: 99,
                social: 149,
                pro: 299,
                enterprise: 499
            };
            
            // Setup fees for each package (one-time payment)
            const setupFees = {
                basic: 199,
                social: 299,
                pro: 499,
                enterprise: 999
            };
            
            // Package features
            function getPackageFeatures(packageType) {
                const features = {
                    basic: [
                        'AI chat widget for websites',
                        'Easy embed'
                    ],
                    social: [
                        'AI chat + AI-generated social content',
                        '1 platform included'
                    ],
                    pro: [
                        'AI chat + message replies + AI social content',
                        '2 platforms included'
                    ],
                    enterprise: [
                        'Full AI suite + all platforms + white-label',
                        'Dedicated support'
                    ]
                };
                return features[packageType] || [];
            }
            
            // Load saved selections from localStorage
            try {
                const saved = localStorage.getItem('packageSelections');
                if (saved) {
                    packageSelections = JSON.parse(saved);
                    console.log('Loaded saved package selections:', packageSelections);
                }
            } catch (e) {
                console.log('Could not load saved selections');
            }
            
            // Initialize with basic package selected
            const basicCard = document.querySelector('.package-card[data-package="basic"]');
            if (basicCard) {
                // Manually select the basic package instead of clicking
                basicCard.classList.add('selected');
                
                // Show the package platforms section for basic
                const basicPlatforms = basicCard.querySelector('.package-platforms');
                if (basicPlatforms) basicPlatforms.style.display = 'block';
                
                // Show the continue button for basic with delay
                const basicContinueBtn = basicCard.querySelector('.package-continue-btn');
                if (basicContinueBtn) {
                    setTimeout(() => {
                        basicContinueBtn.style.display = 'block';
                    }, 300);
                }
                
                const packageName = basicCard.querySelector('h3').textContent;
                const monthlyPrice = basePrices.basic;
                
                selectedPackage = {
                    type: 'basic',
                    name: packageName,
                    monthlyPrice: monthlyPrice,
                    price: setupFees.basic,
                    features: [
                        'AI chat widget for websites',
                        'Easy embed'
                    ]
                };
                
                updateTotal();
            }
            
            packageCards.forEach(card => {
                card.addEventListener('click', function(event) {
                    // Prevent collapse when clicking the continue button
                    if (event.target.tagName === 'BUTTON' && event.target.classList.contains('package-continue-btn')) {
                        return;
                    }
                    
                    const clickedPackageType = this.dataset.package;
                    
                    // Check if this package is already selected (toggle behavior)
                    if (this.classList.contains('selected')) {
                        // Collapse: remove selection and hide sections
                        this.classList.remove('selected');
                        packageCardsContainer.classList.remove('has-selection');
                        const platforms = this.querySelector('.package-platforms');
                        const total = this.querySelector('.package-total');
                        if (platforms) platforms.style.display = 'none';
                        if (total) total.style.display = 'none';
                        
                        // Clear selections
                        selectedPackage = null;
                        selectedPlatforms = [];
                        selectedAddons = [];
                        updateVisualSelections();
                        updateTotal();
                        
                        // Hide all package continue buttons
                        document.querySelectorAll('.package-continue-btn').forEach(btn => {
                            btn.style.display = 'none';
                        });
                        
                        // Hide continue button
                        const continueBtn = document.getElementById('continue-btn');
                        if (continueBtn) continueBtn.disabled = true;
                        
                        return; // Exit early - we're collapsing
                    }
                    
                    // Expand: Remove selected class from all cards and hide their sections
                    packageCards.forEach(c => {
                        c.classList.remove('selected');
                        // Hide expansion sections
                        const platforms = c.querySelector('.package-platforms');
                        const total = c.querySelector('.package-total');
                        if (platforms) platforms.style.display = 'none';
                        if (total) total.style.display = 'none';
                    });
                    
                    // Hide all continue buttons
                    document.querySelectorAll('.package-continue-btn').forEach(btn => {
                        btn.style.display = 'none';
                    });
                    
                    // Select this card
                    this.classList.add('selected');
                    packageCardsContainer.classList.add('has-selection');
                    
                    // Store selected package data
                    const packageType = this.dataset.package;
                    const packageName = this.querySelector('h3').textContent;
                    
                    // Show the continue button for this package
                    const packageContinueBtn = this.querySelector('.package-continue-btn');
                    if (packageContinueBtn) {
                        if (packageType === 'basic') {
                            // Delay showing continue button for basic package to allow expansion to be visible first
                            setTimeout(() => {
                                packageContinueBtn.style.display = 'block';
                            }, 300);
                        } else {
                            packageContinueBtn.style.display = 'block';
                        }
                    }
                    
                    // Show package total for selected package
                    const selectedTotal = this.querySelector('.package-total');
                    if (selectedTotal) selectedTotal.style.display = 'block';
                    
                    selectedPackage = {
                        type: packageType,
                        name: packageName,
                        monthlyPrice: basePrices[packageType],
                        price: setupFees[packageType],
                        features: getPackageFeatures(packageType)
                    };
                    
                    console.log(`Package selected: ${packageType}, base price: $${basePrices[packageType]}/month`);                    // Load saved selections for this package
                    const savedPackageData = packageSelections[packageType] || { platforms: [], addons: [] };
                    selectedPlatforms = [...savedPackageData.platforms];
                    selectedAddons = [...savedPackageData.addons];
                    
                    console.log(`Loaded selections for ${packageType}: platforms [${selectedPlatforms.join(', ')}], addons: ${selectedAddons.length} items`);
                    
                    // Update visual state to match loaded selections
                    updateVisualSelections();
                    
                    console.log('Visual state reset: all selections cleared');                    // Set default addon selections based on package type
                    if (selectedAddons.length === 0) { // Only set defaults if no saved selections
                        if (packageType === 'social') {
                            // Social Starter includes basic storage
                            selectedAddons = [
                                { id: 'photos-10', price: 50 },
                                { id: 'videos-5', price: 75 }
                            ];
                        } else if (packageType === 'pro') {
                            // Pro includes storage + content refinements + AI content
                            selectedAddons = [
                                { id: 'photos-10', price: 50 },
                                { id: 'videos-5', price: 75 },
                                { id: 'iterations-extra', price: 150 },
                                { id: 'ai-content-generation', price: 200 }
                            ];
                        } else if (packageType === 'enterprise') {
                            // Enterprise includes everything
                            selectedAddons = [
                                { id: 'photos-10', price: 50 },
                                { id: 'videos-5', price: 75 },
                                { id: 'iterations-extra', price: 150 },
                                { id: 'ai-content-generation', price: 200 },
                                { id: 'white-label-chat', price: 150 }
                            ];
                        }
                        console.log(`Set default addons for ${packageType}: ${selectedAddons.map(a => a.id).join(', ')}`);
                    }
                    
                    // Show expansion sections for all packages
                    if (packageType === 'basic' || packageType === 'social' || packageType === 'pro' || packageType === 'enterprise') {
                        const platforms = this.querySelector('.package-platforms');
                        if (platforms) {
                            platforms.style.display = 'block';
                            // Only setup platform and addon selection for packages that have them
                            if (packageType === 'social' || packageType === 'pro' || packageType === 'enterprise') {
                                // Check if extra cost indicators should be shown based on current selection
                                console.log(`Package ${packageType} selected, selectedPlatforms: [${selectedPlatforms.join(', ')}], included: ${getIncludedPlatforms(selectedPackage.type)}`);
                                if (selectedPackage.type !== 'enterprise' && selectedPlatforms.length >= getIncludedPlatforms(selectedPackage.type)) {
                                    console.log('Adding show-extra-cost');
                                    platforms.classList.add('show-extra-cost');
                                    // Show indicators on unselected platforms, hide on selected
                                    const allIndicators = platforms.querySelectorAll('.extra-cost-indicator');
                                    console.log(`Found ${allIndicators.length} indicators`);
                                    allIndicators.forEach((indicator, index) => {
                                        const platformOption = indicator.closest('.platform-option');
                                        if (platformOption) {
                                            const platform = platformOption.dataset.platform;
                                            const isSelected = platformOption.classList.contains('selected');
                                            console.log(`Indicator ${index} for ${platform}: selected=${isSelected}`);
                                            if (isSelected) {
                                                indicator.style.opacity = '0';
                                                console.log(`Set ${platform} indicator to 0`);
                                            } else {
                                                indicator.style.opacity = '1';
                                                console.log(`Set ${platform} indicator to 1`);
                                            }
                                        }
                                    });
                                } else {
                                    console.log('Removing show-extra-cost');
                                    platforms.classList.remove('show-extra-cost');
                                    // Hide all indicators
                                    const allIndicators = platforms.querySelectorAll('.extra-cost-indicator');
                                    allIndicators.forEach(indicator => {
                                        indicator.style.opacity = '0';
                                    });
                                }
                                setupPlatformSelection(platforms);
                                setupAddonSelection(platforms); // Addons are now inside platforms
                            }
                        }
                    }
                    
                    // Update total
                    updateTotal();
                    console.log('updateTotal called from package selection');
                    
                    // Enable continue button
                    const continueBtn = document.getElementById('continue-btn');
                    if (continueBtn) {
                        continueBtn.disabled = false;
                    }
                });
            });
            
            // Add click handlers for package continue buttons
            document.querySelectorAll('.package-continue-btn').forEach(btn => {
                btn.addEventListener('click', function(event) {
                    event.stopPropagation();
                    
                    if (!selectedPackage) {
                        alert('Please select a package first');
                        return;
                    }
                    
                    // Calculate final total (setup fee + first month recurring)
                    let subtotal = selectedPackage.price + selectedPackage.monthlyPrice;
                    
                    // Add platform costs (1 included, additional $15 each)
                    if (selectedPlatforms.length > 1) {
                        const extraPlatforms = selectedPlatforms.length - 1;
                        subtotal += extraPlatforms * 15;
                    }
                    
                    // Add addons
                    const positiveAddons = selectedAddons.filter(addon => addon.price > 0);
                    const negativeAddons = selectedAddons.filter(addon => addon.price < 0);
                    
                    subtotal += positiveAddons.reduce((sum, addon) => sum + addon.price, 0);
                    subtotal += negativeAddons.reduce((sum, addon) => sum + addon.price, 0);
                    
                    const total = subtotal;
                    
                    // Store quote data
                    const quoteData = {
                        package: selectedPackage,
                        addons: selectedAddons,
                        platforms: selectedPlatforms,
                        total: total,
                        timestamp: new Date().toISOString()
                    };
                    
                    localStorage.setItem('quoteData', JSON.stringify(quoteData));
                    
                    // Navigate to customization
                    if (typeof navigateToStep === 'function') {
                        navigateToStep(3);
                    } else {
                        window.location.href = 'customization.html';
                    }
                });
            });
            
            function getIncludedPlatforms(packageType) {
                if (packageType === 'social') return 1;
                if (packageType === 'pro') return 2;
                if (packageType === 'enterprise') return 3;
                return 0;
            }
            
            function getIncludedAddons(packageType) {
                if (packageType === 'social') return ['photos-10', 'videos-5'];
                if (packageType === 'pro') return ['photos-10', 'videos-5', 'iterations-extra', 'ai-content-generation'];
                if (packageType === 'enterprise') return ['photos-10', 'videos-5', 'iterations-extra', 'ai-content-generation', 'white-label-chat'];
                return [];
            }
            
            function setupPlatformSelection(container) {
                const platformOptions = container.querySelectorAll('.platform-option');
                platformOptions.forEach(option => {
                    // Remove existing listeners
                    option.removeEventListener('click', handlePlatformClick);
                    option.addEventListener('click', handlePlatformClick);
                });
            }
            
            function handlePlatformClick(event) {
                event.stopPropagation(); // Prevent event bubbling to package card
                const platform = this.dataset.platform;
                
                console.log(`Platform ${platform} clicked, currently selected: ${this.classList.contains('selected')}`);
                
                if (this.classList.contains('selected')) {
                    this.classList.remove('selected');
                    selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
                    console.log(`Deselected ${platform}, platforms now: [${selectedPlatforms.join(', ')}]`);
                } else {
                    this.classList.add('selected');
                    selectedPlatforms.push(platform);
                    console.log(`Selected ${platform}, platforms now: [${selectedPlatforms.join(', ')}]`);
                }
                
                // Show/hide extra cost indicators based on selection and package type
                const platformsContainer = this.closest('.package-platforms');
                if (platformsContainer && selectedPackage.type !== 'enterprise') { // Enterprise includes all platforms
                    console.log(`After click: selectedPlatforms: [${selectedPlatforms.join(', ')}], included: ${getIncludedPlatforms(selectedPackage.type)}`);
                    if (selectedPlatforms.length >= getIncludedPlatforms(selectedPackage.type)) {
                        console.log('Adding show-extra-cost in click handler');
                        platformsContainer.classList.add('show-extra-cost');
                        // Show indicators on unselected platforms, hide on selected
                        const allIndicators = platformsContainer.querySelectorAll('.extra-cost-indicator');
                        console.log(`Found ${allIndicators.length} indicators in click`);
                        allIndicators.forEach((indicator, index) => {
                            const platformOption = indicator.closest('.platform-option');
                            if (platformOption) {
                                const plat = platformOption.dataset.platform;
                                const isSel = platformOption.classList.contains('selected');
                                console.log(`Click indicator ${index} for ${plat}: selected=${isSel}`);
                                if (isSel) {
                                    indicator.style.opacity = '0';
                                    console.log(`Set ${plat} indicator to 0 in click`);
                                } else {
                                    indicator.style.opacity = '1';
                                    console.log(`Set ${plat} indicator to 1 in click`);
                                }
                            }
                        });
                    } else {
                        console.log('Removing show-extra-cost in click handler');
                        platformsContainer.classList.remove('show-extra-cost');
                        // Hide all indicators when under limit
                        const allIndicators = platformsContainer.querySelectorAll('.extra-cost-indicator');
                        allIndicators.forEach(indicator => {
                            indicator.style.opacity = '0';
                        });
                    }
                }
                
                updateTotal();
                console.log('updateTotal called from platform selection');
                savePackageSelections();
            }
            
            function updateVisualSelections() {
                // Reset all visual selections first
                document.querySelectorAll('.platform-option.selected').forEach(option => {
                    option.classList.remove('selected');
                });
                document.querySelectorAll('.addon-card.selected').forEach(card => {
                    card.classList.remove('selected', 'included');
                });
                
                // Apply current selections
                selectedPlatforms.forEach(platform => {
                    const option = document.querySelector(`.package-card.selected .platform-option[data-platform="${platform}"]`);
                    if (option) option.classList.add('selected');
                });
                
                selectedAddons.forEach(addon => {
                    const card = document.querySelector(`.package-card.selected .addon-card[data-addon="${addon.id}"]`);
                    if (card) {
                        card.classList.add('selected');
                        // Mark as included if it's part of the package
                        const includedAddons = getIncludedAddons(selectedPackage.type);
                        if (includedAddons.includes(addon.id)) {
                            card.classList.add('included');
                        }
                    }
                });
                
                console.log('Updated visual selections to match current data');
            }
            
            function savePackageSelections() {
                if (selectedPackage) {
                    packageSelections[selectedPackage.type] = {
                        platforms: [...selectedPlatforms],
                        addons: [...selectedAddons]
                    };
                    
                    try {
                        localStorage.setItem('packageSelections', JSON.stringify(packageSelections));
                        console.log(`Saved selections for ${selectedPackage.type}`);
                    } catch (e) {
                        console.log('Could not save selections');
                    }
                }
            }
            
            function setupAddonSelection(container) {
                const addonCards = container.querySelectorAll('.addon-card');
                const includedAddons = getIncludedAddons(selectedPackage.type);
                
                addonCards.forEach(card => {
                    const addonId = card.dataset.addon;
                    const priceElement = card.querySelector('.addon-price');
                    
                    // Show all addon cards
                    card.style.display = 'block';
                    
                    if (includedAddons.includes(addonId)) {
                        // Mark as included - selected and strikethrough price
                        card.classList.add('selected', 'included');
                        if (priceElement) {
                            priceElement.style.textDecoration = 'line-through';
                            priceElement.style.opacity = '0.5';
                        }
                        // Remove click listener for included addons
                        card.removeEventListener('click', handleAddonClick);
                        card.style.cursor = 'default';
                    } else {
                        // Regular addon - remove included styling and add click listener
                        card.classList.remove('included');
                        if (priceElement) {
                            priceElement.style.textDecoration = 'none';
                            priceElement.style.opacity = '1';
                        }
                        card.style.cursor = 'pointer';
                        // Remove existing listeners first
                        card.removeEventListener('click', handleAddonClick);
                        card.addEventListener('click', handleAddonClick);
                    }
                });
            }
            
            function handleAddonClick(event) {
                event.stopPropagation(); // Prevent event bubbling to package card
                const addonId = this.dataset.addon;
                const addonPrice = parseFloat(this.dataset.price);
                const addonName = this.querySelector('.addon-name').textContent;
                
                // Don't allow clicking on included addons
                if (this.classList.contains('included')) {
                    return;
                }
                
                console.log(`Addon ${addonName} (${addonId}) clicked, price: $${addonPrice}, currently selected: ${this.classList.contains('selected')}`);
                
                if (this.classList.contains('selected')) {
                    this.classList.remove('selected');
                    selectedAddons = selectedAddons.filter(addon => addon.id !== addonId);
                    console.log(`Deselected ${addonName}, addons now: ${selectedAddons.length} items`);
                } else {
                    this.classList.add('selected');
                    selectedAddons.push({
                        id: addonId,
                        name: addonName,
                        price: addonPrice
                    });
                    console.log(`Selected ${addonName} (+$${addonPrice}), addons now: ${selectedAddons.length} items`);
                }
                
                updateTotal();
                savePackageSelections();
            }
            
            function updateTotal() {
                if (!selectedPackage) {
                    console.log('updateTotal called but no package selected');
                    return;
                }
                
                console.log(`updateTotal called for ${selectedPackage.type}, base price: $${selectedPackage.monthlyPrice}`);
                
                let subtotal = selectedPackage.monthlyPrice;
                console.log(`Starting subtotal: $${subtotal}`);
                
                // Add platform costs based on package type
                let includedPlatforms = 0;
                if (selectedPackage.type === 'social') {
                    includedPlatforms = 1; // Social Starter includes 1 platform
                } else if (selectedPackage.type === 'pro') {
                    includedPlatforms = 2; // Pro includes 2 platforms
                } else if (selectedPackage.type === 'enterprise') {
                    includedPlatforms = 3; // Enterprise includes all platforms
                }
                
                if (selectedPlatforms.length > includedPlatforms) {
                    const extraPlatforms = selectedPlatforms.length - includedPlatforms;
                    const platformCost = extraPlatforms * 15;
                    subtotal += platformCost;
                    console.log(`Added ${extraPlatforms} extra platforms: +$${platformCost}, subtotal now: $${subtotal}`);
                } else {
                    console.log(`No extra platforms needed (${selectedPlatforms.length}/${includedPlatforms} included)`);
                }
                
                // Add addons (only charge for addons not included in package)
                let includedAddons = [];
                if (selectedPackage.type === 'social') {
                    includedAddons = ['photos-10', 'videos-5'];
                } else if (selectedPackage.type === 'pro') {
                    includedAddons = ['photos-10', 'videos-5', 'iterations-extra', 'ai-content-generation'];
                } else if (selectedPackage.type === 'enterprise') {
                    includedAddons = ['photos-10', 'videos-5', 'iterations-extra', 'ai-content-generation', 'white-label-chat'];
                }
                
                const chargeableAddons = selectedAddons.filter(addon => !includedAddons.includes(addon.id));
                const positiveAddons = chargeableAddons.filter(addon => addon.price > 0);
                const negativeAddons = chargeableAddons.filter(addon => addon.price < 0);
                
                const positiveTotal = positiveAddons.reduce((sum, addon) => sum + addon.price, 0);
                const negativeTotal = negativeAddons.reduce((sum, addon) => sum + addon.price, 0);
                
                subtotal += positiveTotal;
                subtotal += negativeTotal;
                
                console.log(`Addons: ${positiveAddons.length} chargeable positive (+$${positiveTotal}), ${negativeAddons.length} chargeable negative ($${negativeTotal}), subtotal now: $${subtotal}`);
                console.log(`Included addons (free): ${includedAddons.join(', ')}`);
                
                // Update price in selected package card
                const priceElement = document.getElementById(`${selectedPackage.type}-price`);
                if (priceElement) {
                    priceElement.textContent = `$${subtotal}/month`;
                    console.log(`Updated price element ${selectedPackage.type}-price to: $${subtotal}/month`);
                } else {
                    console.log(`Could not find price element ${selectedPackage.type}-price`);
                }
            }
            
            // Position floating total on window resize
            window.addEventListener('resize', function() {
                const floatingTotal = document.getElementById('floatingTotal');
                if (floatingTotal && floatingTotal.classList.contains('visible')) {
                    const deviceContainer = document.querySelector('.device-container');
                    if (deviceContainer) {
                        const containerRect = deviceContainer.getBoundingClientRect();
                        floatingTotal.style.right = (window.innerWidth - containerRect.right + 20) + 'px';
                    }
                }
            });
            const continueBtn = document.getElementById('continue-btn');
            if (continueBtn) {
                continueBtn.addEventListener('click', function() {
                    if (!selectedPackage) {
                        alert('Please select a package first');
                        return;
                    }
                    
                    // Calculate final total (setup fee + first month recurring)
                    let subtotal = selectedPackage.price + selectedPackage.monthlyPrice;
                    
                    // Add platform costs (1 included, additional $15 each)
                    if (selectedPlatforms.length > 1) {
                        const extraPlatforms = selectedPlatforms.length - 1;
                        subtotal += extraPlatforms * 15;
                    }
                    
                    // Add addons
                    const positiveAddons = selectedAddons.filter(addon => addon.price > 0);
                    const negativeAddons = selectedAddons.filter(addon => addon.price < 0);
                    
                    subtotal += positiveAddons.reduce((sum, addon) => sum + addon.price, 0);
                    subtotal += negativeAddons.reduce((sum, addon) => sum + addon.price, 0);
                    
                    const total = subtotal;
                    
                    // Store quote data
                    const quoteData = {
                        package: selectedPackage,
                        addons: selectedAddons,
                        platforms: selectedPlatforms,
                        total: total,
                        timestamp: new Date().toISOString()
                    };
                    
                    localStorage.setItem('quoteData', JSON.stringify(quoteData));
                    
                    // Navigate to customization
                    if (typeof navigateToStep === 'function') {
                        navigateToStep(3);
                    } else {
                        window.location.href = 'customization.html';
                    }
                });
            }
        });
    </script>
</body>
</html>
