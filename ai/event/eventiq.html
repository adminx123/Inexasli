<!--
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
-->

<script src="../../payment/paymentform.js"></script>

<div class="device-container">
<div class="premium-blur">

<div class="row1" style="padding: 20px; text-align: center; background-color: #f0f8ff; border-bottom: 1px solid #ddd; margin-bottom: 20px;">
    <h2 style="color: #333; font-size: 24px; margin-bottom: 10px;">Plan Your Perfect Event, Effortlessly!</h2>
    <p style="color: #555; font-size: 16px; line-height: 1.6; margin-bottom: 15px;">
        Organizing an event, big or small? EventIQ helps you streamline the planning process. By answering some key questions about your event's goals, budget, and preferences, you'll enable our AI to provide tailored suggestions, checklists, and ideas. This helps you stay organized, consider all angles, and create a memorable occasion.
    </p>
    <p style="color: #777; font-size: 12px; line-height: 1.5; border: 1px solid #e0e0e0; padding: 10px; background-color: #fff9e6; border-radius: 5px;">
        <em>Important: The information and suggestions provided by this tool are for informational and educational purposes only and are generated by artificial intelligence. They are not a substitute for professional event planning advice or services, and we make no guarantees regarding their accuracy, completeness, or suitability for your specific event. Vendor suggestions, if any, are not endorsements. Use of this tool and its outputs is at your own risk.</em>
    </p>
    <p style="color: #555; font-size: 16px; line-height: 1.6; margin-top: 15px;">
        Let's start planning your successful event!
    </p>
</div>
        <div class="row1">
            <label class="category-label">Event Type</label>
            <div class="grid-container" id="event-types">
                <div class="grid-item" data-value="Birthday">Birthday</div>
                <div class="grid-item" data-value="Wedding">Wedding</div>
                <div class="grid-item" data-value="House Party">House Party</div>
                <div class="grid-item" data-value="Corporate Event">Corporate Event</div>
                <div class="grid-item" data-value="Family Reunion">Family Reunion</div>
                <div class="grid-item" data-value="Concert">Concert</div>
                <div class="grid-item" data-value="Graduation">Graduation</div>
                <div class="grid-item" data-value="Festival">Festival</div>
                <div class="grid-item" data-value="Charity Event">Charity Event</div>
                <div class="grid-item" data-value="Community Gathering">Community Gathering</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Venue Status</label>
            <select id="event-venue">
                <option value="" disabled selected>Select Venue Status</option>
                <option value="Venue Secured">Venue Secured</option>
                <option value="Venue Needed">Venue Needed</option>
            </select>
        </div>
        <div class="row1">
            <label class="category-label">Location Type</label>
            <select id="event-location">
                <option value="" disabled selected>Select Location Type</option>
                <option value="indoors">Indoors</option>
                <option value="outdoors">Outdoors</option>
            </select>
        </div>
        <div class="row1" id="event-requirements">
            <label class="category-label">Requirements</label>
            <div class="grid-container" id="event-setup">
                <div class="grid-item" data-value="Seating">Seating</div>
                <div class="grid-item" data-value="Lighting">Lighting</div>
                <div class="grid-item" data-value="Decor">Decor</div>
                <div class="grid-item" data-value="Catering">Catering</div>
                <div class="grid-item" data-value="Microphone">Microphone</div>
                <div class="grid-item" data-value="Wi-Fi">Wi-Fi</div>
                <div class="grid-item" data-value="Sound Equipment">Sound Equipment</div>
                <div class="grid-item" data-value="Restrooms">Restrooms</div>
                <div class="grid-item" data-value="Registration">Registration Desk</div>
                <div class="grid-item" data-value="Security">Security</div>
                <div class="grid-item" data-value="Tent">Tent</div>
                <div class="grid-item" data-value="BackupPlan">Backup Plan</div>
                <div class="grid-item" data-value="Heaters">Heaters</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Event Elements</label>
            <div class="grid-container" id="event-elements">
                <div class="grid-item" data-value="Food">Food</div>
                <div class="grid-item" data-value="Drinks">Drinks</div>
                <div class="grid-item" data-value="Alcoholic Drinks">Alcoholic Drinks</div>
                <div class="grid-item" data-value="Photography">Photography</div>
                <div class="grid-item" data-value="Games">Games</div>
                <div class="grid-item" data-value="Live Entertainment">Live Entertainment</div>
                <div class="grid-item" data-value="Decorations">Decorations</div>
                <div class="grid-item" data-value="Music">Music</div>
                <div class="grid-item" data-value="Invitations">Invitations</div>
                <div class="grid-item" data-value="Gift Bags">Gift Bags</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Attendance & Budget</label>
            <input type="number" id="event-guests" placeholder="50" min="1">
            <input type="number" id="event-budget" placeholder="5000">
        </div>
        <div class="row1">
            <label class="category-label">Event Time</label>
            <label for="event-start">Start:</label>
            <input type="time" id="event-start" name="event-start">
            <label for="event-end">End:</label>
            <input type="time" id="event-end" name="event-end">
        </div>
        <div class="row1">
            <label class="category-label">Event Location</label>
            <textarea id="event-specific-location" rows="1" placeholder="123 Main St, New York"></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Additional Context</label>
            <textarea id="event-specific-context" rows="3" placeholder="Majority of attendees have an Italian background
Most individuals between 5-10 yrs old
Need accommodations for 3 wheelchair users"></textarea>
       
            <button class="generate-btn" id="generate-event-btn">Generate EventIQâ„¢ Plan</button>
        </div>
  

<script>
/*
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
*/

(function() {
    console.log("EventIQ script initializing");

    // Initialize FormPersistence for eventiq module
    const fields = [
        { id: 'event-types', type: 'grid' },
        { id: 'event-venue', type: 'dropdown' },
        { id: 'event-location', type: 'dropdown' },
        { id: 'event-setup', type: 'grid' },
        { id: 'event-elements', type: 'grid' },
        { id: 'event-guests', type: 'input' },
        { id: 'event-budget', type: 'input' },
        { id: 'event-start', type: 'input' },
        { id: 'event-end', type: 'input' },
        { id: 'event-specific-location', type: 'textarea' },
        { id: 'event-specific-context', type: 'textarea' }
    ];

    // FormPersistence will be initialized by datain.js as window.eventFormPersistence
    // No need to create a new instance here

    // Listen for grid-item-toggled event from datain.js
    function handleGridItemToggled(event) {
        console.log('[EventIQ] Grid item toggled event received');
        // UI behavior only - persistence handled centrally
    }

    // Handle the generate button click
    async function handleGenerateEventIq() {
        console.log('[EventIQ] Generate button clicked.');
        
        const result = await window.enhancedLoading(
            'generate-event-btn',
            'event',
            async () => {
                const formData = window.eventFormPersistence.getSavedFormData();
                if (!formData) {
                    console.error('[EventIQ] No input data found in localStorage.');
                    throw new Error('Please complete the form before generating an event plan.');
                }
                
                // Send data to worker
                const apiUrl = 'https://event.4hm7q4q75z.workers.dev/';
                
                console.log('[EventIQ] Sending eventIqInput to worker');
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                
                const responseData = await response.json();
                console.log('[EventIQ] Worker response:', responseData);
                
                if (responseData.message !== 'Success') {
                    throw new Error(`An error occurred: ${responseData.message || responseData.error || ''}`);
                }
                
                // Store the response
                window.eventFormPersistence.saveResponseData(responseData);
                
                // Dispatch an event to notify dataout.js that a response was received
                const event = new CustomEvent('api-response-received', {
                    detail: {
                        module: 'eventiq',
                        type: 'worker-response',
                        timestamp: Date.now()
                    }
                });
                document.dispatchEvent(event);
                console.log('[EventIQ] Dispatched api-response-received event');
                
                return responseData;
            }
        );
        
        // Enhanced loading either returns result or throws error - no need to check result.success
        console.log('[EventIQ] Event plan generated successfully');
    }

    // Initialization
    document.addEventListener('grid-item-toggled', handleGridItemToggled);
    document.getElementById('generate-event-btn').addEventListener('click', handleGenerateEventIq);

    // Guided forms integration
    if (typeof GuidedForms !== 'undefined' && GuidedForms.eventiq) {
        new GuidedForms.eventiq();
    }
})();
</script>
</div>
</div>
