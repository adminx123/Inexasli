<!--
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmotionIQ™ - Emotional Processing Analysis</title>
    <link rel="stylesheet" href="/style/styles.css">
</head>
<body>
    <a href="/ai/landing/landing.html">
        <img src="/images/apple-touch-icon.png" alt="Logo" style="width: 25px; height: auto; display: block; margin: 15px;">
    </a>

    <div class="container">
        <div class="row1">
            <label class="category-label">Therapy Goal</label>
            <textarea id="emotioniq-goal" rows="3" placeholder="e.g., Manage anxiety, process grief, improve self-esteem"></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Emotional State</label>
            <div class="grid-container" id="emotioniq-emotions">
                <div class="grid-item" data-value="Anxious">Anxious</div>
                <div class="grid-item" data-value="Sad">Sad</div>
                <div class="grid-item" data-value="Angry">Angry</div>
                <div class="grid-item" data-value="Overwhelmed">Overwhelmed</div>
                <div class="grid-item" data-value="Numb">Numb</div>
                <div class="grid-item" data-value="Hopeful">Hopeful</div>
                <div class="grid-item" data-value="Confused">Confused</div>
                <div class="grid-item" data-value="Guilty">Guilty</div>
                <div class="grid-item" data-value="Excited">Excited</div>
                <div class="grid-item" data-value="Lonely">Lonely</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Triggers & Stressors</label>
            <div class="grid-container" id="emotioniq-triggers">
                <div class="grid-item" data-value="Work">Work Stress</div>
                <div class="grid-item" data-value="Relationships">Relationships</div>
                <div class="grid-item" data-value="Family">Family Issues</div>
                <div class="grid-item" data-value="Finances">Finances</div>
                <div class="grid-item" data-value="Health">Health Concerns</div>
                <div class="grid-item" data-value="Past Trauma">Past Trauma</div>
                <div class="grid-item" data-value="Social Pressure">Social Pressure</div>
                <div class="grid-item" data-value="Lack of Sleep">Lack of Sleep</div>
                <div class="grid-item" data-value="Change">Recent Changes</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Recent Events</label>
            <textarea id="emotioniq-recent" rows="4" placeholder="What's been on your mind lately? (1 per line):\nHad a fight with my partner\nFelt overwhelmed at work\nCouldn't sleep last night"></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Coping Strategies</label>
            <div class="grid-container" id="emotioniq-coping">
                <div class="grid-item" data-value="Talking">Talking to Someone</div>
                <div class="grid-item" data-value="Exercise">Exercise</div>
                <div class="grid-item" data-value="Meditation">Meditation</div>
                <div class="grid-item" data-value="Journalizing">Journalizing</div>
                <div class="grid-item" data-value="Distraction">Distraction (e.g., TV, games)</div>
                <div class="grid-item" data-value="Avoidance">Avoidance</div>
                <div class="grid-item" data-value="Sleep">Sleeping More</div>
                <div class="grid-item" data-value="Hobbies">Hobbies</div>
                <div class="grid-item" data-value="Therapy">Therapy/Counseling</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Therapy History</label>
            <textarea id="emotioniq-history" rows="3" placeholder="e.g., I've been in therapy for 6 months, I had a tough childhood, etc."></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Context Details</label>
            <textarea id="emotioniq-context" rows="4" placeholder="Anything from your past or future that might relate (1 per line):\nHad a tough breakup last year\nWorried about a big presentation next week\nChildhood memory of being ignored"></textarea>
        </div>
        <div class="row1">
            <button class="generate-btn" id="generate-emotion-btn">Generate EmotionIQ™ Analysis</button>
            <button class="clear-btn" id="clear-emotion-btn">Clear All</button>
        </div>
    </div>

<script>
/*
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
*/

(function() {
    const setJSON = window.setJSON || function(k,v){ if(!k) return; if(v===undefined) return localStorage.removeItem(k); localStorage.setItem(k,JSON.stringify(v)); };
    const getJSON = window.getJSON || function(k,def){ try{const v=localStorage.getItem(k); return v?JSON.parse(v):def;}catch{return def;} };

    function collectFormData(){
        const data={ goal:null, emotions:[], triggers:[], recent:null, coping:[], history:null, context:null };
        const g=document.getElementById('emotioniq-goal'); if(g&&g.value.trim()) data.goal=g.value.trim();
        document.querySelectorAll('#emotioniq-emotions .grid-item.selected').forEach(i=>data.emotions.push(i.dataset.value));
        document.querySelectorAll('#emotioniq-triggers .grid-item.selected').forEach(i=>data.triggers.push(i.dataset.value));
        const r=document.getElementById('emotioniq-recent'); if(r&&r.value.trim()) data.recent=r.value.trim();
        document.querySelectorAll('#emotioniq-coping .grid-item.selected').forEach(i=>data.coping.push(i.dataset.value));
        const h=document.getElementById('emotioniq-history'); if(h&&h.value.trim()) data.history=h.value.trim();
        const c=document.getElementById('emotioniq-context'); if(c&&c.value.trim()) data.context=c.value.trim();
        return data;
    }

    function saveAll(){ setJSON('emotionIqInput', collectFormData()); }
    function customToggle(e){ e.stopPropagation(); e.preventDefault(); this.classList.toggle('selected'); saveAll(); }

    function repopulateForm(){ const d=getJSON('emotionIqInput',{}); if(!d) return;
        if(d.goal) document.getElementById('emotioniq-goal').value=d.goal;
        (d.emotions||[]).forEach(v=>{ const el=document.querySelector(`#emotioniq-emotions .grid-item[data-value='${v}']`); if(el) el.classList.add('selected'); });
        (d.triggers||[]).forEach(v=>{ const el=document.querySelector(`#emotioniq-triggers .grid-item[data-value='${v}']`); if(el) el.classList.add('selected'); });
        if(d.recent) document.getElementById('emotioniq-recent').value=d.recent;
        (d.coping||[]).forEach(v=>{ const el=document.querySelector(`#emotioniq-coping .grid-item[data-value='${v}']`); if(el) el.classList.add('selected'); });
        if(d.history) document.getElementById('emotioniq-history').value=d.history;
        if(d.context) document.getElementById('emotioniq-context').value=d.context;
    }

    function clearData(){ if(!confirm('Clear all saved data?')) return; localStorage.removeItem('emotionIqInput'); localStorage.removeItem('emotionIqResponse'); document.querySelectorAll('.grid-item.selected').forEach(i=>i.classList.remove('selected')); document.querySelectorAll('textarea').forEach(t=>t.value=''); }

    async function generate(){ const btn=document.getElementById('generate-emotion-btn'); const old=btn.innerText; btn.innerText='Loading...'; btn.disabled=true;
        const data=getJSON('emotionIqInput'); if(!data||!data.goal){ alert('Please complete the form'); btn.innerText=old; btn.disabled=false; return; }
        try{ const res=await fetch('https://emotioniqworker.4hm7q4q75z.workers.dev/',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
            const json=await res.json(); setJSON('emotionIqResponse',json); document.dispatchEvent(new CustomEvent('api-response-received',{detail:{module:'emotioniq',type:'worker-response',timestamp:Date.now()}})); btn.innerText='Success!';
        }catch(e){ console.error(e); alert('Error generating analysis'); btn.innerText='Error'; }
        setTimeout(()=>{ btn.innerText=old; btn.disabled=false; },2000);
    }

    repopulateForm();
    document.querySelectorAll('.grid-container .grid-item').forEach(i=>i.addEventListener('click',customToggle));
    document.querySelectorAll('textarea').forEach(t=>t.addEventListener('change',saveAll));
    document.getElementById('generate-emotion-btn').addEventListener('click',generate);
    document.getElementById('clear-emotion-btn').addEventListener('click',clearData);
})();
</script>
</body>
</html>
