<!-- /*
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
 */ -->

<style>
/* Make premium-tag match datain.js payment button styling */
.premium-tag {
    font-size: 14px !important;
    font-weight: bold !important;
    float: right !important;
    margin-left: auto !important;
}

/* Target grid containers within data-container-in to ensure higher specificity */
.data-container-in .device-container .grid-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    width: 100%;
    max-width: 460px;
    margin: 0 auto;
}

/* Mobile-specific override for data-container-in context */
@media (max-width: 480px) {
    .data-container-in .device-container .grid-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        max-width: 360px;
    }
    
    .data-container-in .device-container .grid-item {
        min-height: 50px;
        padding: 0.75rem;
        font-size: 14px;
    }
}

@media (max-width: 375px) {
    .data-container-in .device-container .grid-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 6px;
        max-width: 340px;
    }
}

@media (max-width: 320px) {
    .data-container-in .device-container .grid-container {
        grid-template-columns: 1fr;
        max-width: 280px;
    }
}


</style>

<div class="device-container">
<div class="row1" data-step-label="Select Category">

        <div class="grid-container" id="category-selection">

        <div class="grid-item" data-value="all" style="font-weight: bold;">ALL PRODUCTS</div>




        <div class="grid-item" data-value="health">HEALTH</div>
        <div class="grid-item" data-value="business">BUSINESS</div>
        <div class="grid-item" data-value="finance">FINANCE</div>
        <div class="grid-item" data-value="lifestyle">LIFESTYLE</div>
        <div class="grid-item" data-value="learning">LEARNING</div>
        <div class="grid-item" data-value="productivity">PRODUCTIVITY</div>
    </div>
</div>


<div class="row1" data-step-label="Products">
    <div class="grid-container">
        <!-- Health Products -->
        <div class="grid-item" data-category="health" data-value="/ai/calorie/calorieiq.html">CalorieIQ™</div>
        
        <!-- Business Products -->
        <div class="grid-item" data-category="business,productivity" data-value="/ai/decision/decisioniq.html">DecisionIQ™ <span class="premium-tag">$</span></div>
        
        <!-- Finance Products -->
        <div class="grid-item" data-category="finance" data-value="/ai/income/incomeiq.html">IncomeIQ™ <span class="premium-tag">$</span></div>
        
        <!-- Lifestyle Products -->
        <div class="grid-item" data-category="lifestyle" data-value="/ai/event/eventiq.html">EventIQ™ <span class="premium-tag">$</span></div>
        <div class="grid-item" data-category="lifestyle" data-value="/ai/social/socialiq.html">SocialIQ™ <span class="premium-tag">$</span></div>
        <div class="grid-item" data-category="lifestyle,learning" data-value="/ai/philosophy/philosophyiq.html">PhilosophyIQ™</div>
        <div class="grid-item" data-category="lifestyle" data-value="/ai/enneagram/enneagramiq.html">EnneagramIQ™ <span class="premium-tag">$</span></div>
        
        <!-- Learning Products -->
        <div class="grid-item" data-category="learning" data-value="/ai/research/researchiq.html">ResearchIQ™ <span class="premium-tag">$</span></div>
        <div class="grid-item" data-category="learning" data-value="/ai/quiz/quiziq.html">QuizIQ™</div>
    </div>
</div>
</div>

<script>
// Execute immediately instead of waiting for DOMContentLoaded since this is dynamically loaded
(function() {
    console.log('[Categories] Script executing immediately');
    
    // Function to filter products using DIRECT INLINE STYLES (bypasses all CSS)
    function filterProducts(selectedCategory) {
        const products = document.querySelectorAll('.grid-item[data-category]');
        console.log('[Categories] filterProducts called with:', selectedCategory, 'Found products:', products.length);
        
        products.forEach(product => {
            const categories = product.getAttribute('data-category').split(',');
            
            if (selectedCategory === 'all' || categories.includes(selectedCategory)) {
                // FORCE SHOW with inline style (overrides everything)
                product.style.display = 'flex';
                console.log('[Categories] Showing:', product.textContent);
            } else {
                // FORCE HIDE with inline style (overrides everything)
                product.style.display = 'none';
                console.log('[Categories] Hiding:', product.textContent);
            }
        });
        
        // Store selection in localStorage for other modules to access
        localStorage.setItem('categoriesPageSelection', selectedCategory);
        console.log('[Categories] Category filtered:', selectedCategory, 'Total products found:', products.length);
    }
    
    // Wait a bit for DOM to be ready, then initialize
    setTimeout(function() {
        // Add category selection logic
        const categoryContainer = document.getElementById('category-selection');
        console.log('[Categories] Category container found:', !!categoryContainer);
        
        if (categoryContainer) {
            categoryContainer.addEventListener('click', function(e) {
                console.log('[Categories] Click detected on:', e.target);
                if (e.target.classList.contains('grid-item')) {
                    const selectedCategory = e.target.getAttribute('data-value');
                    console.log('[Categories] Category clicked:', selectedCategory);
                    
                    // Prevent event bubbling to avoid conflicts with datain.js
                    e.stopPropagation();
                    
                    // Update active state
                    document.querySelectorAll('#category-selection .grid-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    e.target.classList.add('active');
                    
                    // Filter products with FORCE
                    filterProducts(selectedCategory);
                }
            });
            
            // Initialize: FORCE HIDE all products first, then show 'all'
            console.log('[Categories] Initializing - hiding all products first');
            const allProducts = document.querySelectorAll('.grid-item[data-category]');
        allProducts.forEach(product => {
            product.style.display = 'none';
        });
        
        // Now show all products and set active
        setTimeout(() => {
            filterProducts('all');
            const allCategoriesItem = document.querySelector('#category-selection .grid-item[data-value="all"]');
            if (allCategoriesItem) {
                allCategoriesItem.classList.add('active');
            }
        }, 100);
        }
    }, 100);
    
    // Add product selection logic (unchanged)
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('grid-item') && e.target.getAttribute('data-value') && e.target.getAttribute('data-value').startsWith('/ai/')) {
            const url = e.target.getAttribute('data-value');
            
            // Use regular content loading for all modules
            const gridItemEvent = new CustomEvent('promptGridItemSelected', { 
                detail: { url: url }
            });
            document.dispatchEvent(gridItemEvent);
            
            // Store the URL in localStorage for persistence
            if (typeof window.setLocal === 'function') {
                window.setLocal('lastGridItemUrl', url);
            } else {
                localStorage.setItem('lastGridItemUrl', url);
            }
        }
    });
})();
</script>