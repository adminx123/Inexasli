<!--
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
-->

    <a href="/ai/landing/landing.html">
        <img src="/images/apple-touch-icon.png" alt="Logo" style="width: 25px; height: auto; display: block; margin: 15px;">
    </a>

        <div class="row1">
            <label class="category-label">Business Idea</label>
            <textarea id="business-vision" rows="1" placeholder="What's your business idea? e.g., Launch a coffee shop"></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Experience Level</label>
            <div class="grid-container" id="business-knowledge-level">
                <div class="grid-item" data-value="New">I'm New to Business</div>
                <div class="grid-item" data-value="Intermediate">I've Run a Business Before</div>
                <div class="grid-item" data-value="Sophisticated">I'm an Experienced Entrepreneur</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Your Strengths</label>
            <div class="grid-container" id="business-general-skills">
                <div class="grid-item" data-value="Communication">I Communicate Well</div>
                <div class="grid-item" data-value="Problem-Solving">I Solve Problems</div>
                <div class="grid-item" data-value="Teamwork">I Work in Teams</div>
                <div class="grid-item" data-value="Time-Management">I Manage Time</div>
                <div class="grid-item" data-value="Adaptability">I Adapt Easily</div>
                <div class="grid-item" data-value="Critical-Thinking">I Think Critically</div>
                <div class="grid-item" data-value="Leadership">I Lead Others</div>
                <div class="grid-item" data-value="Creativity">I'm Creative</div>
                <div class="grid-item" data-value="Work-Ethic">I Have Strong Work Ethic</div>
                <div class="grid-item" data-value="Interpersonal">I Connect with People</div>
                <div class="grid-item" data-value="Organization">I Stay Organized</div>
                <div class="grid-item" data-value="Attention-to-Detail">I Focus on Details</div>
                <div class="grid-item" data-value="Decision-Making">I Make Decisions</div>
                <div class="grid-item" data-value="Analytical">I Analyze Well</div>
                <div class="grid-item" data-value="Initiative">I Take Initiative</div>
                <div class="grid-item" data-value="Technical">I'm Tech-Savvy</div>
                <div class="grid-item" data-value="Emotional-Intelligence">I Understand Emotions</div>
                <div class="grid-item" data-value="Negotiation">I Negotiate Effectively</div>
                <div class="grid-item" data-value="Resilience">I'm Resilient</div>
                <div class="grid-item" data-value="Project-Management">I Manage Projects</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Your Challenges</label>
            <div class="grid-container" id="business-weaknesses">
                <div class="grid-item" data-value="Procrastination">I Procrastinate</div>
                <div class="grid-item" data-value="Impatience">I'm Impatient</div>
                <div class="grid-item" data-value="Disorganization">I'm Disorganized</div>
                <div class="grid-item" data-value="Overthinking">I Overthink</div>
                <div class="grid-item" data-value="Perfectionism">I'm a Perfectionist</div>
                <div class="grid-item" data-value="Lack-of-Confidence">I Lack Confidence</div>
                <div class="grid-item" data-value="Difficulty-Delegating">I Struggle to Delegate</div>
                <div class="grid-item" data-value="Poor-Time-Management">I Manage Time Poorly</div>
                <div class="grid-item" data-value="Indecisiveness">I'm Indecisive</div>
                <div class="grid-item" data-value="Fear-of-Failure">I Fear Failure</div>
                <div class="grid-item" data-value="Limited-Technical-Skills">I Lack Tech Skills</div>
                <div class="grid-item" data-value="Overcommitting">I Overcommit</div>
                <div class="grid-item" data-value="Lack-of-Focus">I Lose Focus</div>
                <div class="grid-item" data-value="Impulsiveness">I'm Impulsive</div>
                <div class="grid-item" data-value="Difficulty-with-Feedback">I Resist Feedback</div>
                <div class="grid-item" data-value="Resistance-to-Change">I Resist Change</div>
                <div class="grid-item" data-value="Poor-Communication">I Communicate Poorly</div>
                <div class="grid-item" data-value="Stress-Management">I Handle Stress Badly</div>
                <div class="grid-item" data-value="Lack-of-Initiative">I Lack Initiative</div>
                <div class="grid-item" data-value="Detail-Overload">I Miss the Big Picture</div>
            </div>
        </div>
        <div class="row1">
            <label class="category-label">Resources & Tools</label>
            <textarea id="business-organization" rows="4" placeholder="Business Equipment & Tools (1 per line):\nQuickBooks for accounting\nShopify for e-commerce\nLadder\nWelding Torch"></textarea>
        </div>
        <div class="row1">
            <label class="category-label">Network & Connections</label>
            <textarea id="business-network" rows="4" placeholder="Who can you leverage? (1 per line):\nFriend who owns a cafÃ©\nLocal Chamber of Commerce\nBusiness mentor"></textarea>
        </div>
        <div class="row1">
            <button class="generate-btn" id="generate-business-btn">Generate Business Plan Now!</button>
            <button class="clear-btn" id="clear-business-btn">Clear All</button>
        </div>

<script>
/*
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
*/
(function() {
    console.log("Business IQ script initializing");

    // JSON storage helpers
    const setJSON = window.setJSON || function(name, value) {
        try {
            if (!name) return false;
            if (value === undefined) { localStorage.removeItem(name); return true; }
            localStorage.setItem(name, JSON.stringify(value));
            console.log(`[BusinessIQ] JSON saved ${name}`);
            return true;
        } catch (e) { console.error(`[BusinessIQ] Error storing JSON: ${e}`); return false; }
    };
    const getJSON = window.getJSON || function(name, defaultValue) {
        try {
            const item = localStorage.getItem(name);
            return item ? JSON.parse(item) : defaultValue;
        } catch (e) { console.error(`[BusinessIQ] Error retrieving JSON: ${e}`); return defaultValue; }
    };

    function customToggleGridItem(event) {
        event.stopPropagation(); event.preventDefault();
        const container = this.closest('.grid-container');
        if (container.id === 'business-knowledge-level') {
            container.querySelectorAll('.grid-item').forEach(i => i.classList.remove('selected'));
            this.classList.add('selected');
        } else {
            this.classList.toggle('selected');
        }
        saveGridItem(this);
        console.log(`[BusinessIQ] Toggled ${this.dataset.value} in ${container.id}`);
    }

    function saveGridItem(item) {
        console.log('[BusinessIQ] Saving all form data to JSON');
        setJSON('businessIqInput', collectFormData());
    }

    function saveInput(input) {
        console.log('[BusinessIQ] Saving all form data to JSON');
        setJSON('businessIqInput', collectFormData());
    }

    function collectFormData() {
        const formData = { vision:null, knowledgeLevel:null, strengths:[], weaknesses:[], organization:null, network:null };
        if (document.getElementById('business-vision').value.trim()) formData.vision = document.getElementById('business-vision').value.trim();
        const lvl = document.querySelector('#business-knowledge-level .grid-item.selected'); if (lvl) formData.knowledgeLevel = lvl.dataset.value;
        document.querySelectorAll('#business-general-skills .grid-item.selected').forEach(i=>formData.strengths.push(i.dataset.value));
        document.querySelectorAll('#business-weaknesses .grid-item.selected').forEach(i=>formData.weaknesses.push(i.dataset.value));
        if (document.getElementById('business-organization').value.trim()) formData.organization = document.getElementById('business-organization').value.trim();
        if (document.getElementById('business-network').value.trim()) formData.network = document.getElementById('business-network').value.trim();
        return formData;
    }

    function repopulateForm() {
        console.log('[BusinessIQ] Repopulating form from JSON storage');
        const data = getJSON('businessIqInput', null);
        if (!data) return;
        if (data.vision) document.getElementById('business-vision').value = data.vision;
        if (data.knowledgeLevel) document.querySelector(`#business-knowledge-level .grid-item[data-value="${data.knowledgeLevel}"]`)?.classList.add('selected');
        data.strengths?.forEach(v => document.querySelector(`#business-general-skills .grid-item[data-value="${v}"]`)?.classList.add('selected'));
        data.weaknesses?.forEach(v => document.querySelector(`#business-weaknesses .grid-item[data-value="${v}"]`)?.classList.add('selected'));
        if (data.organization) document.getElementById('business-organization').value = data.organization;
        if (data.network) document.getElementById('business-network').value = data.network;
    }

    function setupInputHandlers() {
        document.querySelectorAll('textarea').forEach(i => i.addEventListener('change', () => saveInput(i)));
    }

    function clearLocalStorage() {
        if (!confirm('Are you sure you want to clear all saved data? This action cannot be undone.')) return;
        localStorage.removeItem('businessIqInput');
        localStorage.removeItem('businessIqResponse');
        document.querySelectorAll('.grid-container .grid-item').forEach(i => i.classList.remove('selected'));
        document.querySelectorAll('textarea').forEach(i => i.value = '');
    }

    async function handleGenerateBusinessIq() {
        const btn = document.getElementById('generate-business-btn');
        const initText = btn.innerText; btn.innerText = 'Loading...'; btn.disabled = true;
        try {
            const formData = getJSON('businessIqInput');
            if (!formData) { alert('Please complete the form before generating a business plan.'); throw new Error('No input data'); }
            const apiUrl = 'https://business.4hm7q4q75z.workers.dev/';
            const response = await fetch(apiUrl, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(formData) });
            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
            const data = await response.json();
            setJSON('businessIqResponse', data);
            btn.innerText = 'Success!'; setTimeout(() => btn.disabled = false, 1000);
            document.dispatchEvent(new CustomEvent('api-response-received', { detail: { module: 'businessiq', type: 'worker-response', timestamp: Date.now() } }));
        } catch (e) {
            console.error('[BusinessIQ] Error generating business plan:', e);
            alert('An error occurred while generating your business plan.');
            btn.innerText = 'Error'; setTimeout(() => { btn.innerText = initText; btn.disabled = false; }, 2000);
        }
    }

    function setupButtonHandlers() {
        document.getElementById('generate-business-btn').addEventListener('click', handleGenerateBusinessIq);
        document.getElementById('clear-business-btn').addEventListener('click', clearLocalStorage);
    }

    function initialize() {
        console.log('[BusinessIQ] Initializing...');
        document.querySelectorAll('.grid-container .grid-item').forEach(i => i.addEventListener('click', customToggleGridItem, { capture: true }));
        setupInputHandlers(); setupButtonHandlers(); repopulateForm();
    }

    initialize();
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initialize);
    document.addEventListener('data-in-loaded', () => setTimeout(initialize, 100));

    window.businessIq = { initialize, saveGridItem, saveInput, clearLocalStorage, getFormData: collectFormData };
})();
</script>