<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App IQ</title>
  <!--
   * Copyright (c) 2025 INEXASLI. All rights reserved.
   * This code is protected under Canadian and international copyright laws.
   * Unauthorized use, reproduction, distribution, or modification of this code 
   * without explicit written permission via email from info@inexasli.com 
   * is strictly prohibited. Violators will be pursued and prosecuted to the 
   * fullest extent of the law in British Columbia, Canada, and applicable 
   * jurisdictions worldwide.
  -->
</head>
<body>
  <a href="/ai/landing/landing.html">
    <img src="/images/apple-touch-icon.png" alt="Logo" style="width: 25px; height: auto; display: block; margin: 15px;">
  </a>

  <div class="row1">
    <label class="category-label">App Purpose</label>
    <textarea id="app-purpose" rows="4" placeholder="e.g., task management"></textarea>
  </div>
  <div class="row1">
    <label class="category-label">Development Status</label>
    <div class="grid-container" id="app-code-status">
      <div class="grid-item" data-value="code-started">I Have Code Started</div>
      <div class="grid-item" data-value="no-code">I Have No Code</div>
    </div>
  </div>
  <div class="row1">
    <label class="category-label">App Features</label>
    <div class="grid-container" id="app-features">
      <div class="grid-item" data-value="Notifications">I Want Notifications</div>
      <div class="grid-item" data-value="User Accounts">I Want User Accounts</div>
      <div class="grid-item" data-value="Payments">I Want Payments</div>
      <div class="grid-item" data-value="Offline Mode">I Want Offline Mode</div>
      <div class="grid-item" data-value="Contact Form">I Want a Contact Form</div>
      <div class="grid-item" data-value="Mobile Responsiveness">I Want Mobile Responsiveness</div>
      <div class="grid-item" data-value="About Us">I Want About Us</div>
      <div class="grid-item" data-value="E-commerce Platform">I Want an E-commerce Platform</div>
      <div class="grid-item" data-value="Payment Gateway">I Want a Payment Gateway</div>
      <div class="grid-item" data-value="Gallery">I Want a Gallery</div>
      <div class="grid-item" data-value="Social Media Integration">I Want Social Media Integration</div>
      <div class="grid-item" data-value="Testimonials">I Want Testimonials</div>
      <div class="grid-item" data-value="FAQ Section">I Want an FAQ Section</div>
      <div class="grid-item" data-value="Blog Integration">I Want Blog Integration</div>
      <div class="grid-item" data-value="Custom Graphics">I Want Custom Graphics</div>
      <div class="grid-item" data-value="Calculation Functionality">I Want Calculation Functionality</div>
      <div class="grid-item" data-value="Event Calendar">I Want an Event Calendar</div>
    </div>
  </div>
  <div class="row1">
    <label class="category-label">Target Platform</label>
    <textarea id="app-platform" rows="1" placeholder="e.g., iOS, Android"></textarea>
  </div>
  <div class="row1">
    <label class="category-label">Budget</label>
    <textarea id="app-budget" rows="1" placeholder="e.g., $5000"></textarea>
  </div>
  <div class="row1">
    <label class="category-label">Timeline</label>
    <textarea id="app-timeline" rows="1" placeholder="e.g., 3 months"></textarea>
  </div>
  <button class="generate-btn" id="generate-app-btn">Generate App Plan Now!</button>
  <button class="clear-btn" id="clear-app-btn">Clear All</button>

  <script>
  /*
   * Copyright (c) 2025 INEXASLI. All rights reserved.
   * This code is protected under Canadian and international copyright laws.
   * Unauthorized use, reproduction, distribution, or modification of this code 
   * without explicit written permission via email from info@inexasli.com 
   * is strictly prohibited. Violators will be pursued and prosecuted to the 
   * fullest extent of the law in British Columbia, Canada, and applicable 
   * jurisdictions worldwide.
  */
  (function() {
    console.log("App IQ script initializing");

    const setJSON = window.setJSON || function(name, value) {
      try {
        if (name === undefined || name === null || name === '') {
          console.error('Invalid key name provided to setJSON');
          return false;
        }
        
        if (value === undefined) {
          console.warn(`Warning: Storing undefined value for ${name} in localStorage`);
          localStorage.removeItem(name);
          return true;
        }
        
        const jsonString = JSON.stringify(value);
        localStorage.setItem(name, jsonString);
        console.log(`[AppIQ] JSON saved ${name}`);
        return true;
      } catch (error) {
        console.error(`[AppIQ] Error storing JSON: ${error}`);
        return false;
      }
    };

    const getJSON = window.getJSON || function(name, defaultValue) {
      try {
        const item = localStorage.getItem(name);
        if (!item) return defaultValue;
        const parsedValue = JSON.parse(item);
        console.log(`[AppIQ] JSON retrieved ${name}`);
        return parsedValue;
      } catch (error) {
        console.error(`[AppIQ] Error retrieving JSON: ${error}`);
        return defaultValue;
      }
    };

    function customToggleGridItem(event) {
      event.stopPropagation();
      event.preventDefault();
      const container = this.closest('.grid-container');
      container.querySelectorAll('.grid-item').forEach(item => item.classList.remove('selected'));
      this.classList.add('selected');
      saveGridItem(this);
    }

    function saveGridItem(item) {
      console.log('[AppIQ] Saving all form data to JSON');
      const formData = collectFormData();
      setJSON('appIqInput', formData);
    }

    function saveInput(input) {
      console.log('[AppIQ] Saving all form data to JSON');
      const formData = collectFormData();
      setJSON('appIqInput', formData);
    }

    function collectFormData() {
      const formData = {
        purpose: null,
        codeStatus: null,
        features: [],
        platform: null,
        budget: null,
        timeline: null
      };
      
      const purposeInput = document.getElementById('app-purpose');
      if (purposeInput && purposeInput.value.trim()) {
        formData.purpose = purposeInput.value.trim();
      }
      
      const codeStatusItem = document.querySelector('#app-code-status .grid-item.selected');
      if (codeStatusItem) {
        formData.codeStatus = codeStatusItem.dataset.value;
      }
      
      document.querySelectorAll('#app-features .grid-item.selected').forEach(item => {
        formData.features.push(item.dataset.value);
      });
      
      const platformInput = document.getElementById('app-platform');
      if (platformInput && platformInput.value.trim()) {
        formData.platform = platformInput.value.trim();
      }
      
      const budgetInput = document.getElementById('app-budget');
      if (budgetInput && budgetInput.value.trim()) {
        formData.budget = budgetInput.value.trim();
      }
      
      const timelineInput = document.getElementById('app-timeline');
      if (timelineInput && timelineInput.value.trim()) {
        formData.timeline = timelineInput.value.trim();
      }
      
      return formData;
    }

    function repopulateForm() {
      console.log("[AppIQ] Repopulating form from JSON storage");
      const stored = getJSON('appIqInput', null);
      if (!stored) return;
      
      const purposeInput = document.getElementById('app-purpose');
      if (purposeInput && stored.purpose) {
        purposeInput.value = stored.purpose;
      }
      
      if (stored.codeStatus) {
        const item = document.querySelector(`#app-code-status .grid-item[data-value="${stored.codeStatus}"]`);
        if (item) {
          item.classList.add('selected');
        }
      }
      
      if (stored.features && Array.isArray(stored.features)) {
        stored.features.forEach(feature => {
          const item = document.querySelector(`#app-features .grid-item[data-value="${feature}"]`);
          if (item) {
            item.classList.add('selected');
          }
        });
      }
      
      const platformInput = document.getElementById('app-platform');
      if (platformInput && stored.platform) {
        platformInput.value = stored.platform;
      }
      
      const budgetInput = document.getElementById('app-budget');
      if (budgetInput && stored.budget) {
        budgetInput.value = stored.budget;
      }
      
      const timelineInput = document.getElementById('app-timeline');
      if (timelineInput && stored.timeline) {
        timelineInput.value = stored.timeline;
      }
    }

    function setupInputHandlers() {
      document.querySelectorAll('textarea').forEach(input => {
        input.addEventListener('change', function() {
          saveInput(this);
        });
      });
    }

    function clearLocalStorage() {
      if (!confirm("Are you sure you want to clear all saved data?")) return;
      localStorage.removeItem('appIqInput');
      localStorage.removeItem('appIqResponse');
      document.querySelectorAll('.grid-item').forEach(item => item.classList.remove('selected'));
      document.querySelectorAll('textarea').forEach(input => input.value = '');
    }

    async function handleGenerateAppIq() {
      const btn = document.getElementById('generate-app-btn');
      const init = btn.innerText;
      btn.innerText = 'Loading...';
      btn.disabled = true;
      try {
        const formData = getJSON('appIqInput');
        if (!formData) {
          alert('Complete form first');
          btn.innerText = init;
          btn.disabled = false;
          return;
        }
        const apiUrl = 'https://appiqworker.4hm7q4q75z.workers.dev/';
        const res = await fetch(apiUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        const data = await res.json();
        setJSON('appIqResponse', data);
      } catch (e) {
        console.error(e);
        alert('Error');
      }
      btn.innerText = init;
      btn.disabled = false;
    }

    repopulateForm();
    setupInputHandlers();
    document.getElementById('generate-app-btn').addEventListener('click', handleGenerateAppIq);
    document.getElementById('clear-app-btn').addEventListener('click', clearLocalStorage);
    document.querySelectorAll('.grid-item').forEach(item => item.addEventListener('click', customToggleGridItem, { capture: true }));

  })();
  </script>
</body>
</html>
