# NOTE: For multi-worker projects, deploy each worker using:
#   npx wrangler deploy --env <worker>
# Example for research worker:
#   npx wrangler deploy --env research
# This ensures the correct script, bindings, and environment are used.

account_id = "b70c309587ed8ba2bfa06320792ea457"
workers_dev = true
compatibility_date = "2025-05-11"

# Global build configuration that applies to all workers
[build]
command = ""
watch_dir = "build/worker"

# --- Worker Environments ---

[env.research]
name = "research"
main = "./ai/research/research.js"

# KV namespace for AI-generated facts
[[env.research.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.research.services]]
binding = "secret_binding"
service = "secretworker"

[[env.research.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"



[env.calorie]
name = "calorie"
main = "./ai/calorie/calorie.js"

# KV namespace for AI-generated facts
[[env.calorie.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.calorie.services]]
binding = "secret_binding"
service = "secretworker"

[[env.calorie.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.income]
name = "income"
main = "./ai/income/income.js"

# KV namespace for AI-generated facts
[[env.income.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

# Service bindings for the income worker
[[env.income.services]]
binding = "secret_binding"
service = "secretworker"

[[env.income.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.book]
name = "book"
main = "./ai/book/book.js"

[[env.book.services]]
binding = "secret_binding"
service = "secretworker"

[[env.book.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"



[env.decision]
name = "decision"
main = "./ai/decision/decision.js"

# KV namespace for AI-generated facts
[[env.decision.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.decision.services]]
binding = "secret_binding"
service = "secretworker"

[[env.decision.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.enneagram]
name = "enneagram"
main = "./ai/enneagram/enneagram.js"

# KV namespace for AI-generated facts
[[env.enneagram.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.enneagram.services]]
binding = "secret_binding"
service = "secretworker"

[[env.enneagram.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.event]
name = "event"
main = "./ai/event/event.js"

# KV namespace for AI-generated facts
[[env.event.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.event.services]]
binding = "secret_binding"
service = "secretworker"

[[env.event.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.fitness]
name = "fitness"
main = "./ai/fitness/fitness.js"

# KV namespace for AI-generated facts
[[env.fitness.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.fitness.services]]
binding = "secret_binding"
service = "secretworker"

[[env.fitness.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.philosophy]
name = "philosophy"
main = "./ai/philosophy/philosophy.js"

# KV namespace for AI-generated facts
[[env.philosophy.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.philosophy.services]]
binding = "secret_binding"
service = "secretworker"

[[env.philosophy.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.fact-generator]
name = "fact-generator"
main = "./ai/fact-generator/fact-generator.js"

# Weekly cron job - runs every Sunday at 2 AM UTC
[env.fact-generator.triggers]
crons = ["0 2 * * SUN"]

# KV namespace for storing generated facts
[[env.fact-generator.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.fact-generator.services]]
binding = "secret_binding"
service = "secretworker"

[[env.fact-generator.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"



[env.social]
name = "social"
main = "./ai/social/social.js"

# KV namespace for AI-generated facts
[[env.social.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.social.services]]
binding = "secret_binding"
service = "secretworker"

[[env.social.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.fashion]
name = "fashion"
main = "./ai/fashion/fashion.js"

# KV namespace for AI-generated facts
[[env.fashion.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.fashion.services]]
binding = "secret_binding"
service = "secretworker"

[[env.fashion.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

[env.quiz]
name = "quiz"
main = "./ai/quiz/quiz.js"

# KV namespace for AI-generated facts
[[env.quiz.kv_namespaces]]
binding = "FACT_STORE"
id = "285495ae3e0f468a86f47bdd056ecfc3"
preview_id = "02f5fab88e5143a5aa52c315fde404d1"

[[env.quiz.services]]
binding = "secret_binding"
service = "secretworker"

[[env.quiz.services]]
binding = "rate_limiter_binding"
service = "rate-limiter"

# --- Rate Limiter Worker (CRITICAL - Deploy First) ---
[env.rate-limiter]
name = "rate-limiter"
main = "./ai/rate-limiter/rate-limiter.js"

# KV namespace for rate limiting data storage
[[env.rate-limiter.kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "2da5e6f46847458a9aa83ffe54dea66e"
preview_id = "2da5e6f46847458a9aa83ffe54dea66e"

# --- Worker Environments ---
