<!-- /*
 * Copyright (c) 2025 INEXASLI. All rights reserved.
 * This code is protected under Canadian and international copyright laws.
 * Unauthorized use, reproduction, distribution, or modification of this code 
 * without explicit written permission via email from info@inexasli.com 
 * is strictly prohibited. Violators will be pursued and prosecuted to the 
 * fullest extent of the law in British Columbia, Canada, and applicable 
 * jurisdictions worldwide.
 */ -->

<div class="device-container" id="fishingiq-device-container" >
  <div class="row1">
    <div class="product-card">
      <div class="product-icon-container">
        <i class="bx bx-fish product-icon"></i>
      </div>
  <div class="product-headline">Fishing Regulator</div>
      <p class="product-description-text">
        This tool helps anglers understand BC Canada fishing regulations by providing species identification, seasonal information, size limits, and location-specific rules. Upload photos of caught fish or specify target species to get accurate regulatory guidance.
      </p>
      <div class="product-divider"></div>
      <p class="product-description-final">
        Ready to check fishing regulations!
      </p>
      <p class="product-description-disclaimer">
        <em>This is an informational tool only. All content is generated by third-party AI systems and is for educational and informational purposes. This is not legal advice. Fishing regulations can change - always verify with official sources. AI can make mistakes and generate inaccurate information. For official fishing regulations, consult provincial authorities.</em>
      </p>
    </div>
  </div>

  <!-- Stage 2: Intent Selection -->
  <div class="row1">
    <label class="category-label">What would you like to do?</label>
    <div class="grid-container" id="fishing-intent" data-single-select>
      <div class="grid-item" data-value="planning">I'm going fishing</div>
      <div class="grid-item" data-value="caught">I caught a fish</div>
    </div>
  </div>

  <!-- Stage 3: Location Input -->
  <div class="row1">
    <input id="fishing-location" type="text" placeholder="Fishing Location (e.g., Fraser River, Vancouver Island)">
  </div>

  <!-- Stage 4: Conditional Content -->
  <div id="fishing-planning-stage" class="row1" style="display: none;">
    <label class="category-label">What fish are you trying to catch?</label>
    <input id="target-species" type="text" placeholder="Target species (e.g., salmon, trout, bass)">
  </div>

  <div id="fishing-caught-stage" class="row1" style="display: none;">
    <label class="category-label">Upload a photo of your catch</label>
    <div id="fish-image-upload-container" class="image-upload-container" data-image-upload data-module="fishing" data-max-images="1"></div>
  </div>

</div>

<script type="module">
// Import required utilities
import { initializeGuidedForms } from '/utility/guidedForms.js';

// Initialize guided forms for 4-stage flow
document.addEventListener('DOMContentLoaded', function() {
  // Define the stages
  const stages = [
    { id: 'product-description', required: false }, // Stage 1
    { id: 'fishing-intent', required: true },       // Stage 2
    { id: 'fishing-location', required: true },     // Stage 3
    { id: 'conditional-stage', required: true }     // Stage 4 (planning or caught)
  ];

  // Initialize guided forms
  initializeGuidedForms('fishingiq-device-container', stages, {
    onStageChange: function(currentStage, direction) {
      updateConditionalContent();
    }
  });

  // Handle intent selection changes
  document.getElementById('fishing-intent').addEventListener('click', function(e) {
    if (e.target.classList.contains('grid-item')) {
      updateConditionalContent();
    }
  });

  function updateConditionalContent() {
    const selectedIntent = document.querySelector('#fishing-intent .grid-item.selected');
    const planningStage = document.getElementById('fishing-planning-stage');
    const caughtStage = document.getElementById('fishing-caught-stage');

    if (selectedIntent) {
      const intent = selectedIntent.getAttribute('data-value');
      if (intent === 'planning') {
        planningStage.style.display = 'block';
        caughtStage.style.display = 'none';
      } else if (intent === 'caught') {
        planningStage.style.display = 'none';
        caughtStage.style.display = 'block';
        // Initialize image upload for caught fish
        if (typeof window.initializeImageUpload === 'function') {
          window.initializeImageUpload();
        }
      }
    }
  }
});
</script>