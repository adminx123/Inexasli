<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Upload Troubleshooting - INEXASLI</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #4a7c59;
            border-bottom: 2px solid #4a7c59;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #2d5a3d;
            margin-top: 30px;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .status-item {
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .status-pass { background-color: #e8f5e8; border-color: #4caf50; }
        .status-fail { background-color: #ffebee; border-color: #f44336; }
        .status-warn { background-color: #fff8e1; border-color: #ff9800; }
        
        .test-section {
            background-color: #f5f5f5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4a7c59;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            margin: 5px;
            font-family: inherit;
        }
        
        .btn:hover {
            background-color: #2d5a3d;
        }
        
        .troubleshooting-steps {
            background-color: #e7f3ff;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .troubleshooting-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .troubleshooting-steps li {
            margin-bottom: 10px;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 30px;
            color: #4a7c59;
            text-decoration: none;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        #uploadTest {
            border: 2px dashed #4a7c59;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
        }
        
        .device-info {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì∑ Camera & Image Upload Troubleshooting</h1>
        
        <p>Having trouble with the "Take Photo" button? This page will help you diagnose and fix camera access issues.</p>
        
        <h2>üîç System Status Check</h2>
        <div class="status-grid" id="statusGrid">
            <!-- Status items will be populated by JavaScript -->
        </div>
        
        <div class="device-info" id="deviceInfo">
            Loading device information...
        </div>
        
        <h2>üß™ Camera Access Test</h2>
        <div class="test-section">
            <p><strong>Test 1:</strong> Basic camera access (requires permission)</p>
            <button class="btn" onclick="testCameraAccess()">Test Camera Access</button>
            <div id="cameraTestResult"></div>
        </div>
        
        <div class="test-section">
            <p><strong>Test 2:</strong> File input with camera capture</p>
            <div id="uploadTest">
                <label class="btn">
                    Take Photo
                    <input type="file" accept="image/*" capture="camera" style="display: none;" onchange="handleFileTest(this)">
                </label>
                <label class="btn">
                    Choose from Gallery
                    <input type="file" accept="image/*" multiple style="display: none;" onchange="handleFileTest(this)">
                </label>
            </div>
            <div id="fileTestResult"></div>
        </div>
        
        <h2>üõ†Ô∏è Common Solutions</h2>
        
        <div class="troubleshooting-steps">
            <h3>If the camera button opens your gallery instead:</h3>
            <ol>
                <li><strong>Check HTTPS:</strong> Camera access requires a secure connection (HTTPS). If you see "http://" in the address bar, that's likely the issue.</li>
                <li><strong>Grant permissions:</strong> Your browser may have denied camera access. Look for a camera icon in the address bar and click it to change permissions.</li>
                <li><strong>Try a different browser:</strong> Safari on iOS and Chrome on Android generally work best for camera access.</li>
                <li><strong>Check browser settings:</strong> Make sure camera access isn't blocked in your browser's privacy settings.</li>
            </ol>
        </div>
        
        <div class="troubleshooting-steps">
            <h3>If nothing happens when you click "Take Photo":</h3>
            <ol>
                <li><strong>Try the gallery button:</strong> Click "Choose from Gallery" or "Choose Photos" instead.</li>
                <li><strong>Refresh the page:</strong> Sometimes a simple refresh resolves temporary issues.</li>
                <li><strong>Check for pop-up blockers:</strong> Some browsers or extensions may block the file picker.</li>
                <li><strong>Try on a different device:</strong> Test on another phone or tablet to see if it's device-specific.</li>
            </ol>
        </div>
        
        <div class="troubleshooting-steps">
            <h3>For iOS Safari users:</h3>
            <ol>
                <li>Make sure you're using Safari (not Chrome or Firefox) for best camera compatibility.</li>
                <li>Update to the latest iOS version if possible.</li>
                <li>If the camera button opens the gallery, that's normal behavior on some iOS versions.</li>
                <li>You can still take photos through the gallery by selecting "Camera" from the photo picker.</li>
            </ol>
        </div>
        
        <h2>üìû Still Need Help?</h2>
        <p>If you're still experiencing issues after trying these solutions:</p>
        <ul>
            <li>Take a screenshot of the status check above</li>
            <li>Note which device and browser you're using</li>
            <li>Contact support with these details</li>
        </ul>
        
        <a href="/ai/fashion/fashioniq.html" class="back-link">‚Üê Back to Fashion IQ</a>
    </div>
    
    <script>
        // Device and browser detection
        function getDeviceInfo() {
            const ua = navigator.userAgent;
            const info = {
                userAgent: ua,
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua),
                isIOS: /iPad|iPhone|iPod/.test(ua),
                isAndroid: /Android/i.test(ua),
                isSafari: /Safari/i.test(ua) && !/Chrome/i.test(ua),
                isChrome: /Chrome/i.test(ua),
                isFirefox: /Firefox/i.test(ua),
                isSecure: window.location.protocol === 'https:' || window.location.hostname === 'localhost',
                hasGetUserMedia: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),
                touchPoints: navigator.maxTouchPoints || 0,
                screenSize: `${window.screen.width}x${window.screen.height}`,
                windowSize: `${window.innerWidth}x${window.innerHeight}`
            };
            return info;
        }
        
        // Display device information
        function displayDeviceInfo() {
            const info = getDeviceInfo();
            const deviceInfoEl = document.getElementById('deviceInfo');
            
            deviceInfoEl.innerHTML = `
                <strong>Device Information:</strong><br>
                Browser: ${info.isChrome ? 'Chrome' : info.isSafari ? 'Safari' : info.isFirefox ? 'Firefox' : 'Other'}<br>
                Platform: ${info.isIOS ? 'iOS' : info.isAndroid ? 'Android' : info.isMobile ? 'Mobile' : 'Desktop'}<br>
                Protocol: ${window.location.protocol}<br>
                Hostname: ${window.location.hostname}<br>
                Screen: ${info.screenSize} | Window: ${info.windowSize}<br>
                Touch Points: ${info.touchPoints}<br>
                User Agent: ${info.userAgent}
            `;
        }
        
        // Status check
        function performStatusCheck() {
            const info = getDeviceInfo();
            const statusGrid = document.getElementById('statusGrid');
            
            const checks = [
                {
                    name: 'Secure Connection (HTTPS)',
                    status: info.isSecure ? 'pass' : 'fail',
                    message: info.isSecure ? 'Using secure HTTPS connection' : 'HTTP connection detected - camera may not work'
                },
                {
                    name: 'getUserMedia Support',
                    status: info.hasGetUserMedia ? 'pass' : 'fail',
                    message: info.hasGetUserMedia ? 'Browser supports camera access' : 'Browser does not support camera access'
                },
                {
                    name: 'Mobile Device',
                    status: info.isMobile ? 'pass' : 'warn',
                    message: info.isMobile ? 'Mobile device detected' : 'Desktop device - camera capture may not work'
                },
                {
                    name: 'Recommended Browser',
                    status: (info.isIOS && info.isSafari) || (info.isAndroid && info.isChrome) ? 'pass' : 'warn',
                    message: (info.isIOS && info.isSafari) || (info.isAndroid && info.isChrome) ? 
                        'Using recommended browser' : 'Consider using Safari (iOS) or Chrome (Android) for best compatibility'
                }
            ];
            
            statusGrid.innerHTML = checks.map(check => `
                <div class="status-item status-${check.status}">
                    <strong>${check.name}</strong><br>
                    <small>${check.message}</small>
                </div>
            `).join('');
        }
        
        // Camera access test
        async function testCameraAccess() {
            const resultEl = document.getElementById('cameraTestResult');
            resultEl.innerHTML = '<p>‚è≥ Requesting camera access...</p>';
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment' }
                });
                
                resultEl.innerHTML = '<p style="color: green;">‚úÖ Camera access granted! Your camera is working properly.</p>';
                
                // Stop the stream
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                let message = '';
                switch (error.name) {
                    case 'NotAllowedError':
                        message = '‚ùå Camera access denied. Please check browser permissions.';
                        break;
                    case 'NotFoundError':
                        message = '‚ùå No camera found on this device.';
                        break;
                    case 'NotSupportedError':
                        message = '‚ùå Camera access not supported on this browser.';
                        break;
                    default:
                        message = `‚ùå Camera access failed: ${error.message}`;
                }
                
                resultEl.innerHTML = `<p style="color: red;">${message}</p>`;
            }
        }
        
        // File input test
        function handleFileTest(input) {
            const resultEl = document.getElementById('fileTestResult');
            const files = input.files;
            
            if (files.length > 0) {
                resultEl.innerHTML = `<p style="color: green;">‚úÖ File input working! Selected ${files.length} file(s):</p>` +
                    Array.from(files).map(file => `<small>‚Ä¢ ${file.name} (${file.type})</small>`).join('<br>');
            } else {
                resultEl.innerHTML = '<p style="color: orange;">‚ö†Ô∏è No files selected.</p>';
            }
            
            // Reset input
            input.value = '';
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            displayDeviceInfo();
            performStatusCheck();
        });
    </script>
</body>
</html>
