<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Enhancements - INEXASLI</title>
    <link rel="stylesheet" href="salesflow.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
    <style>
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            width: 40%;
            height: 100%;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 4px;
            animation: progressLoad 1s ease-out;
        }
        
        @keyframes progressLoad {
            from { width: 20%; }
            to { width: 40%; }
        }

        /* Base Package Styling - Keep it simple like other selected addons */
        .addon-card.base-package {
            position: relative;
        }

        .addon-card.base-package .addon-name {
            font-weight: 600;
        }

        .addon-card.base-package .addon-description {
            color: #666;
        }

        .addon-card.base-package .addon-price {
            font-weight: 700;
            font-size: 18px;
        }

        .locked-indicator {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            z-index: 10;
        }

        .addon-card.locked {
            pointer-events: none;
            opacity: 1;
        }

        .addon-card.locked .addon-selected-indicator {
            background: #10b981;
        }
    </style>
</head>
<body>
    <div class="splash-container" id="splashContainer" style="padding-top: 40px; position: absolute; top: 0; left: 0; width: 100%; z-index: 2;">
        <img src="../images/favicon.svg" alt="INEXASLI Logo" class="splash-logo" style="margin-top: 20px;">
    </div>

    <div class="device-container" id="mainContent" style="opacity: 0; display: block; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 480px; z-index: 1;">
            <!-- Step Indicator -->
            <div class="step-indicator">
                <a href="packages.html" class="step completed" style="cursor: pointer; text-decoration: none;">
                    <div class="step-number">1</div>
                    <span>Base</span>
                </a>
                <div class="step active">
                    <div class="step-number">2</div>
                    <span>Enhance</span>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <span>Custom</span>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <span>Review</span>
                </div>
                <div class="step">
                    <div class="step-number">5</div>
                    <span>Pay</span>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>

            <!-- Selected Package Summary -->
            <div class="selected-package-summary">
                <div class="selected-package-title" id="selectedPackageName">Review Your Package Selection</div>
                <div class="selected-package-details" id="selectedPackageDetails">
                    Setup fee will be added at checkout • All prices shown are monthly recurring
                </div>
            </div>

            <!-- Add-ons Section -->
            <div class="addons-container">
                <h1 class="addons-title">Your Package & Enhancements</h1>
                <p class="addons-subtitle">Review your base package and add premium enhancements to customize your monthly plan</p>

                <div class="addons-grid">
                    <!-- Base Package (Always Selected) -->
                    <div class="addon-card base-package selected locked" data-addon="base-package" data-price="127">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">Starter Social Media Automation</div>
                        <div class="addon-description">25 Photos • 10 Videos • Instagram, X, Facebook • Full automation platform (monthly)</div>
                        <div class="addon-price">$127</div>
                        <div class="locked-indicator">Base Package</div>
                    </div>

                    <!-- Extra Photos -->
                    <div class="addon-card" data-addon="photos-10" data-price="50">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">+10 Photo Storage</div>
                        <div class="addon-description">Additional capacity for up to 10 more photos in your content library (monthly)</div>
                        <div class="addon-price">+$50</div>
                    </div>

                    <!-- Extra Videos -->
                    <div class="addon-card" data-addon="videos-5" data-price="75">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">+5 Video Storage</div>
                        <div class="addon-description">Additional capacity for up to 5 more videos in your content library (monthly)</div>
                        <div class="addon-price">+$75</div>
                    </div>

                    <!-- Extra Iterations -->
                    <div class="addon-card" data-addon="iterations-extra" data-price="150">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">+10 Content Refinements</div>
                        <div class="addon-description">Additional content refinement rounds for perfecting your posts and messaging (monthly)</div>
                        <div class="addon-price">+$150</div>
                    </div>

                    <!-- AI Content Generation -->
                    <div class="addon-card" data-addon="ai-content-generation" data-price="200">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">AI Content Generation</div>
                        <div class="addon-description">AI-powered creation of engaging, brand-consistent content with multiple refinement rounds (monthly)</div>
                        <div class="addon-price">+$200</div>
                    </div>

                    <!-- Discount Options -->
                    <div class="addon-card discount-addon" data-addon="basic-scheduling" data-price="-25">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">Basic Scheduling Only</div>
                        <div class="addon-description">Simple automated posting without advanced analytics or engagement optimization</div>
                        <div class="addon-price">-$25</div>
                    </div>

                    <div class="addon-card discount-addon" data-addon="reduced-frequency" data-price="-15">
                        <div class="addon-selected-indicator">✓</div>
                        <div class="addon-name">Reduced Posting Frequency</div>
                        <div class="addon-description">Post 3x per week instead of daily - perfect for businesses with less frequent content</div>
                        <div class="addon-price">-$15</div>
                    </div>
                    </div>
                </div>

                <!-- Total Display -->
                <div class="addons-total">
                    <div class="addons-total-label">Monthly Subscription</div>
                    <div class="addons-total-amount" id="totalAmount">$127</div>
                    <div class="setup-notice" style="font-size: 12px; color: #666; margin-top: 5px;">
                        + $397 one-time setup fee
                    </div>
                </div>

                <!-- Continue Button -->
                <button class="btn-continue-to-quote" onclick="generateQuote()">Continue to Order Review</button>

                <!-- Back Button -->
                <a href="packages.html" class="btn-back">← Back to Base Packages</a>
            </div>
            </div>
        </div>
    </div>

                <!-- Legal Footer -->
                <div style="text-align: center; margin: 40px 0 20px 0; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                    <p style="color: #ccc; font-size: 12px; margin: 0;">
                        <a href="#" onclick="showSocialTerms(); return false;" style="color: #4CAF50; text-decoration: none;">Terms of Service</a>
                        • 
                        <a href="#" onclick="showSocialPrivacy(); return false;" style="color: #4CAF50; text-decoration: none;">Privacy Policy</a>
                        • Contact: support@inexasli.com
                    </p>
                </div>

    <script>
        // Splash screen transition
        const splash = document.getElementById('splashContainer');
        const main = document.getElementById('mainContent');
        
        // Start main content fade-in immediately
        main.style.transition = 'opacity 1.2s ease-in';
        
        setTimeout(() => {
            // Start crossfade
            main.style.opacity = '1';
            splash.style.opacity = '0';
            splash.style.transition = 'opacity 1.2s ease-out';
            
            setTimeout(() => {
                splash.style.display = 'none';
                main.style.position = 'static';
            }, 1200);
        }, 1500); // Show splash for 1.5 seconds

        // Load selected package on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadSelectedPackage();
            initializeBasePackage();
            updateTotal();
        });

        // Setup addon listeners after content is visible
        setTimeout(() => {
            setupAddonListeners();
        }, 1600); // After splash screen animation completes

        let selectedPackage = null;
        let selectedAddons = [];

        function initializeBasePackage() {
            // Add base package as always selected (visual only - not for calculations)
            const basePackageCard = document.querySelector('[data-addon="base-package"]');
            if (basePackageCard) {
                basePackageCard.classList.add('selected');
                // Don't add to selectedAddons array - base package is handled separately in calculations
            }
        }

        function loadSelectedPackage() {
            const packageData = localStorage.getItem('selectedPackage');
            if (packageData) {
                selectedPackage = JSON.parse(packageData);
                
                // Update display - simplified since base package is now shown as addon
                document.getElementById('selectedPackageName').textContent = `Review Your ${selectedPackage.name} Package`;
                
                // Conditionally show/hide platform addon based on package
                togglePlatformAddon(selectedPackage.type);
            } else {
                // Redirect back if no package selected
                window.location.href = 'packages.html';
            }
        }

        function togglePlatformAddon(packageType) {
            const platformAddon = document.querySelector('[data-addon="platform-extra"]');
            
            if (platformAddon) {
                if (packageType === 'starter') {
                    // Show platform addon for starter (they have 2 platforms, can upgrade to 3)
                    platformAddon.style.display = 'block';
                } else {
                    // Hide platform addon for professional/enterprise (they already have all 3 platforms)
                    platformAddon.style.display = 'none';
                }
            }
        }

        function getPackagePhotos(type) {
            const photos = { starter: 15, professional: 25, enterprise: 40 };
            return photos[type] || 25;
        }

        function getPackageVideos(type) {
            const videos = { starter: 5, professional: 10, enterprise: 15 };
            return videos[type] || 10;
        }

        function setupAddonListeners() {
            const addonCards = document.querySelectorAll('.addon-card');
            
            addonCards.forEach(card => {
                card.addEventListener('click', function() {
                    const addonId = this.dataset.addon;
                    
                    // Prevent base package from being deselected
                    if (addonId === 'base-package') {
                        return; // Do nothing for base package
                    }
                    
                    const addonPrice = parseFloat(this.dataset.price);
                    const addonName = this.querySelector('.addon-name').textContent;
                    
                    if (this.classList.contains('selected')) {
                        // Remove addon
                        this.classList.remove('selected');
                        selectedAddons = selectedAddons.filter(addon => addon.id !== addonId);
                    } else {
                        // Add addon
                        this.classList.add('selected');
                        selectedAddons.push({
                            id: addonId,
                            name: addonName,
                            price: addonPrice
                        });
                    }
                    
                    updateTotal();
                });
            });
        }

        function updateTotal() {
            if (!selectedPackage) return;
            
            // Start with base package price from selectedPackage (not from addons)
            let subtotal = selectedPackage.monthlyPrice || 127;
            
            // Add positive addons (excluding base package completely)
            const positiveAddons = selectedAddons.filter(addon => addon.price > 0 && addon.id !== 'base-package');
            const negativeAddons = selectedAddons.filter(addon => addon.price < 0 && addon.id !== 'base-package');
            
            subtotal += positiveAddons.reduce((sum, addon) => sum + addon.price, 0);
            
            // Apply dollar discounts directly (no percentage calculation)
            const discountAmount = negativeAddons.reduce((sum, addon) => sum + addon.price, 0);
            
            const grandTotal = subtotal + discountAmount;
            
            document.getElementById('totalAmount').textContent = `$${grandTotal}`;
        }

        function generateQuote() {
            if (!selectedPackage) {
                alert('Please select a package first');
                return;
            }
            
            // Calculate total properly using setup + first month + addons
            let subtotal = selectedPackage.price + (selectedPackage.monthlyPrice || 127);
            
            // Add positive addons (excluding base package completely)
            const positiveAddons = selectedAddons.filter(addon => addon.price > 0 && addon.id !== 'base-package');
            const negativeAddons = selectedAddons.filter(addon => addon.price < 0 && addon.id !== 'base-package');
            
            subtotal += positiveAddons.reduce((sum, addon) => sum + addon.price, 0);
            
            // Apply dollar discounts directly (no percentage calculation)
            const discountAmount = negativeAddons.reduce((sum, addon) => sum + addon.price, 0);
            
            const total = subtotal + discountAmount;
            
            // Store quote data
            const quoteData = {
                package: selectedPackage,
                addons: selectedAddons,
                total: total,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('quoteData', JSON.stringify(quoteData));
            
            // Redirect to customization page
            window.location.href = 'customization.html';
        }
    </script>
    
    <!-- Splash Screen Transition Script -->
    <script>
        // Splash screen transition
        document.addEventListener('DOMContentLoaded', function() {
            const splash = document.getElementById('splashContainer');
            const main = document.getElementById('mainContent');
            
            // Start main content fade-in immediately
            main.style.transition = 'opacity 1.2s ease-in';
            
            setTimeout(() => {
                // Start crossfade
                main.style.opacity = '1';
                splash.style.opacity = '0';
                splash.style.transition = 'opacity 1.2s ease-out';
                
                setTimeout(() => {
                    splash.style.display = 'none';
                    main.style.position = 'static';
                    main.style.left = 'auto';
                    main.style.transform = 'none';
                }, 1200);
            }, 1500); // Show splash for 1.5 seconds
        });
    </script>
    
    <script src="/utility/modal.js"></script>
    <script src="/business/legalSocial.js"></script>
    <script src="step-navigation.js"></script>
</body>
</html>
